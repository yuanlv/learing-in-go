// Hprose for JavaScript v2.0.1
// Copyright (c) 2008-2016 http://hprose.com
// Hprose is freely distributable under the MIT license.
// For all details and documentation:
// https://github.com/hprose/hprose-js

!function(e){"use strict";e.hprose={}}(this),function(e){"use strict";"undefined"==typeof e.btoa&&(e.btoa=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return function(t){var r,n,i,a,o,u,s;for(n=i=0,a=t.length,o=a%3,a-=o,u=a/3<<2,o>0&&(u+=4),r=new Array(u);a>n;)s=t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<8|t.charCodeAt(n++),r[i++]=e[s>>18]+e[s>>12&63]+e[s>>6&63]+e[63&s];return 1===o?(s=t.charCodeAt(n++),r[i++]=e[s>>2]+e[(3&s)<<4]+"=="):2===o&&(s=t.charCodeAt(n++)<<8|t.charCodeAt(n++),r[i++]=e[s>>10]+e[s>>4&63]+e[(15&s)<<2]+"="),r.join("")}}()),"undefined"==typeof e.atob&&(e.atob=function(){var e=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return function(t){var r,n,i,a,o,u,s,c,f,l;if(s=t.length,s%4!==0)return"";if(/[^ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\+\/\=]/.test(t))return"";for(c="="===t.charAt(s-2)?1:"="===t.charAt(s-1)?2:0,f=s,c>0&&(f-=4),f=3*(f>>2)+c,l=new Array(f),o=u=0;s>o&&(r=e[t.charCodeAt(o++)],-1!==r)&&(n=e[t.charCodeAt(o++)],-1!==n)&&(l[u++]=String.fromCharCode(r<<2|(48&n)>>4),i=e[t.charCodeAt(o++)],-1!==i)&&(l[u++]=String.fromCharCode((15&n)<<4|(60&i)>>2),a=e[t.charCodeAt(o++)],-1!==a);)l[u++]=String.fromCharCode((3&i)<<6|a);return l.join("")}}())}(this),function(e,t){"use strict";function r(e){return"get"in e&&"set"in e?function(){return 0===arguments.length?e.get():void e.set(arguments[0])}:"get"in e?e.get:"set"in e?e.set:void 0}function n(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return function(t){return e.apply(t,Array.prototype.slice.call(arguments,1))}}function i(e){for(var t=e.length,r=new Array(t),n=0;t>n;++n)r[n]=e[n];return r}function a(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));var t=e.length;if(1e5>t)return String.fromCharCode.apply(String,l(e));for(var r=65535&t,n=t>>16,i=new Array(r?n+1:n),a=0;n>a;++a)i[a]=String.fromCharCode.apply(String,l(e.subarray(a<<16,a+1<<16)));return r&&(i[n]=String.fromCharCode.apply(String,l(e.subarray(n<<16,t)))),i.join("")}var o="function"!=typeof Object.defineProperties?function(e,n){var i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];i.forEach(function(t){var r=n[t];"value"in r&&(e[t]=r.value)});for(var a in n){var o=n[a];e[a]=t,"value"in o?e[a]=o.value:("get"in o||"set"in o)&&(e[a]=r(o))}}:function(e,t){for(var n in t){var i=t[n];("get"in i||"set"in i)&&(t[n]={value:r(i)})}Object.defineProperties(e,t)},u=function(){},s="function"!=typeof Object.create?function(e,t){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("prototype must be an object or function");u.prototype=e;var r=new u;return u.prototype=null,t&&o(r,t),r}:function(e,t){if(t){for(var n in t){var i=t[n];("get"in i||"set"in i)&&(t[n]={value:r(i)})}return Object.create(e,t)}return Object.create(e)},c=!0;try{String.fromCharCode.apply(String,new Uint8Array([1]))}catch(f){c=!1}var l=c?function(e){return e}:i,h=function(e){for(var t=e.length,r=new Uint8Array(t),n=0;t>n;n++)r[n]=255&e.charCodeAt(n);return r};e.hprose.defineProperties=o,e.hprose.createObject=s,e.hprose.generic=n,e.hprose.toBinaryString=a,e.hprose.toUint8Array=h,e.hprose.toArray=i}(this),function(e,t){"use strict";function r(e,t){for(var r=e.prototype,n=0,a=t.length;a>n;n++){var o=t[n],u=r[o];"function"==typeof u&&"undefined"==typeof e[o]&&(e[o]=i(u))}}if(Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),r=this,n=function(){},i=function(){return r.apply(this instanceof n?this:e,t.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),i.prototype=new n,i}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null===this||this===t)throw new TypeError('"this" is null or not defined');var r=Object(this),n=r.length>>>0;if(0===n)return-1;var i=+Number(arguments[1])||0;if(Math.abs(i)===1/0&&(i=0),i>=n)return-1;for(var a=Math.max(i>=0?i:n-Math.abs(i),0);n>a;){if(a in r&&r[a]===e)return a;a++}return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){if(null===this||this===t)throw new TypeError('"this" is null or not defined');var r=Object(this),n=r.length>>>0;if(0===n)return-1;var i=+Number(arguments[1])||0;Math.abs(i)===1/0&&(i=0);for(var a=i>=0?Math.min(i,n-1):n-Math.abs(i);a>=0;a--)if(a in r&&r[a]===e)return a;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e){if(null===this||this===t)throw new TypeError("this is null or not defined");var r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var i=[],a=arguments[1],o=0;n>o;o++)if(o in r){var u=r[o];e.call(a,u,o,r)&&i.push(u)}return i}),Array.prototype.forEach||(Array.prototype.forEach=function(e){if(null===this||this===t)throw new TypeError("this is null or not defined");var r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var i=arguments[1],a=0;n>a;a++)a in r&&e.call(i,r[a],a,r)}),Array.prototype.every||(Array.prototype.every=function(e){if(null===this||this===t)throw new TypeError("this is null or not defined");var r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var i=arguments[1],a=0;n>a;a++)if(a in r&&!e.call(i,r[a],a,r))return!1;return!0}),Array.prototype.map||(Array.prototype.map=function(e){if(null===this||this===t)throw new TypeError("this is null or not defined");var r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var i=arguments[1],a=new Array(n),o=0;n>o;o++)o in r&&(a[o]=e.call(i,r[o],o,r));return a}),Array.prototype.some||(Array.prototype.some=function(e){if(null===this||this===t)throw new TypeError("this is null or not defined");var r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(var i=arguments[1],a=0;n>a;a++)if(a in r&&e.call(i,r[a],a,r))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(e){if(null===this||this===t)throw new TypeError("this is null or not defined");var r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError("First argument is not callable");if(0===n&&1===arguments.length)throw new TypeError("Array length is 0 and no second argument");var i,a=0;for(arguments.length>=2?i=arguments[1]:(i=r[0],a=1);n>a;++a)a in r&&(i=e.call(t,i,r[a],a,r));return i}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(e){if(null===this||this===t)throw new TypeError("this is null or not defined");var r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError("First argument is not callable");if(0===n&&1===arguments.length)throw new TypeError("Array length is 0 and no second argument");var i,a=n-1;if(arguments.length>=2)i=arguments[1];else for(;;){if(a in r){i=r[a--];break}if(--a<0)throw new TypeError("Array contains no values")}for(;a>=0;)a in r&&(i=e.call(t,i,r[a],a,r)),a--;return i}),Array.prototype.includes||(Array.prototype.includes=function(e){var t=Object(this),r=parseInt(t.length,10)||0;if(0===r)return!1;var n,i=parseInt(arguments[1],10)||0;i>=0?n=i:(n=r+i,0>n&&(n=0));for(var a;r>n;){if(a=t[n],e===a||e!==e&&a!==a)return!0;n++}return!1}),Array.prototype.find||(Array.prototype.find=function(e){if(null===this||this===t)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r,n=Object(this),i=n.length>>>0,a=arguments[1],o=0;i>o;o++)if(r=n[o],e.call(a,r,o,n))return r;return t}),Array.prototype.findIndex||(Array.prototype.findIndex=function(e){if(null===this||this===t)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r,n=Object(this),i=n.length>>>0,a=arguments[1],o=0;i>o;o++)if(r=n[o],e.call(a,r,o,n))return o;return-1}),Array.prototype.fill||(Array.prototype.fill=function(e){if(null===this||this===t)throw new TypeError("this is null or not defined");for(var r=Object(this),n=r.length>>>0,i=arguments[1],a=i>>0,o=0>a?Math.max(n+a,0):Math.min(a,n),u=arguments[2],s=u===t?n:u>>0,c=0>s?Math.max(n+s,0):Math.min(s,n);c>o;)r[o]=e,o++;return r}),Array.prototype.copyWithin||(Array.prototype.copyWithin=function(e,r){if(null===this||this===t)throw new TypeError("this is null or not defined");var n=Object(this),i=n.length>>>0,a=e>>0,o=0>a?Math.max(i+a,0):Math.min(a,i),u=r>>0,s=0>u?Math.max(i+u,0):Math.min(u,i),c=arguments[2],f=c===t?i:c>>0,l=0>f?Math.max(i+f,0):Math.min(f,i),h=Math.min(l-s,i-o),p=1;for(o>s&&s+h>o&&(p=-1,s+=h-1,o+=h-1);h>0;)s in n?n[o]=n[s]:delete n[o],s+=p,o+=p,h--;return n}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.from||(Array.from=function(){var e=Object.prototype.toString,r=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},n=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t},i=Math.pow(2,53)-1,a=function(e){var t=n(e);return Math.min(Math.max(t,0),i)};return function(e){var n=this,i=Object(e);if(null===e||e===t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var o,u=arguments.length>1?arguments[1]:void t;if("undefined"!=typeof u){if(!r(u))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(var s,c=a(i.length),f=r(n)?Object(new n(c)):new Array(c),l=0;c>l;)s=i[l],u?f[l]="undefined"==typeof o?u(s,l):u.call(o,s,l):f[l]=s,l+=1;return f.length=c,f}}()),Array.of||(Array.of=function(){return Array.prototype.slice.call(arguments)}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var r=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>r.length)&&(t=r.length),t-=e.length;var n=r.indexOf(e,t);return-1!==n&&n===t}),String.prototype.includes||(String.prototype.includes=function(){return"number"==typeof arguments[1]?this.length<arguments[0].length+arguments[1].length?!1:this.substr(arguments[1],arguments[0].length)===arguments[0]:-1!==String.prototype.indexOf.apply(this,arguments)}),String.prototype.repeat||(String.prototype.repeat=function(e){var t=this.toString();if(e=+e,e!==e&&(e=0),0>e)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(e=Math.floor(e),0===t.length||0===e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var r="";1===(1&e)&&(r+=t),e>>>=1,0!==e;)t+=t;return r}),String.prototype.trim||(String.prototype.trim=function(){return this.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.toString().replace(/^[\s\xa0]+/,"")}),String.prototype.trimRight||(String.prototype.trimRight=function(){return this.toString().replace(/[\s\xa0]+$/,"")}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(i){if("object"!=typeof i&&"function"!=typeof i||null===i)throw new TypeError("Object.keys called on non-object");var a=[];for(var o in i)e.call(i,o)&&a.push(o);if(t)for(var u=0;n>u;u++)e.call(i,r[u])&&a.push(r[u]);return a}}()),Date.now||(Date.now=function(){return+new Date}),!Date.prototype.toISOString){var n=function(e){return 10>e?"0"+e:e};Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+n(this.getUTCMonth()+1)+"-"+n(this.getUTCDate())+"T"+n(this.getUTCHours())+":"+n(this.getUTCMinutes())+":"+n(this.getUTCSeconds())+"Z"}}var i=e.hprose.generic;r(Array,["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight","includes","find","findIndex","fill","copyWithin"]),r(String,["quote","substring","toLowerCase","toUpperCase","charAt","charCodeAt","indexOf","lastIndexOf","include","startsWith","endsWith","repeat","trim","trimLeft","trimRight","toLocaleLowerCase","toLocaleUpperCase","match","search","replace","split","substr","concat","slice"])}(this),function(e){"use strict";var t="WeakMap"in e,r="Map"in e,n=!0;if(r&&(n="forEach"in new e.Map),!(t&&r&&n)){var i="create"in Object,a=function(){return i?Object.create(null):{}},o=a(),u=0,s=function(e){var t=a(),r=e.valueOf,n=function(n,i){return this===e&&i in o&&o[i]===n?(i in t||(t[i]=a()),t[i]):r.apply(this,arguments)};i&&"defineProperty"in Object?Object.defineProperty(e,"valueOf",{value:n,writable:!0,configurable:!0,enumerable:!1}):e.valueOf=n};if(t||(e.WeakMap=function d(){var e=a(),t=u++;o[t]=e;var r=function(r){if(r!==Object(r))throw new Error("value is not a non-null object");var n=r.valueOf(e,t);return n!==r.valueOf()?n:(s(r),r.valueOf(e,t))},n=this;if(i?n=Object.create(d.prototype,{get:{value:function(e){return r(e).value},writable:!1,configurable:!1,enumerable:!1},set:{value:function(e,t){r(e).value=t},writable:!1,configurable:!1,enumerable:!1},has:{value:function(e){return"value"in r(e)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(e){return delete r(e).value},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){delete o[t],t=u++,o[t]=e},writable:!1,configurable:!1,enumerable:!1}}):(n.get=function(e){return r(e).value},n.set=function(e,t){r(e).value=t},n.has=function(e){return"value"in r(e)},n["delete"]=function(e){return delete r(e).value},n.clear=function(){delete o[t],t=u++,o[t]=e}),arguments.length>0&&Array.isArray(arguments[0]))for(var c=arguments[0],f=0,l=c.length;l>f;f++)n.set(c[f][0],c[f][1]);return n}),!r){var c=function(){var e=a(),t=u++,r=a();o[t]=e;var n=function(n){if(null===n)return r;var i=n.valueOf(e,t);return i!==n.valueOf()?i:(s(n),n.valueOf(e,t))};return{get:function(e){return n(e).value},set:function(e,t){n(e).value=t},has:function(e){return"value"in n(e)},"delete":function(e){return delete n(e).value},clear:function(){delete o[t],t=u++,o[t]=e}}},f=function(){var e=a();return{get:function(){return e.value},set:function(t,r){e.value=r},has:function(){return"value"in e},"delete":function(){return delete e.value},clear:function(){e=a()}}},l=function(){var e=a();return{get:function(t){return e[t]},set:function(t,r){e[t]=r},has:function(t){return t in e},"delete":function(t){return delete e[t]},clear:function(){e=a()}}};if(!i)var h=function(){var e={};return{get:function(t){return e["!"+t]},set:function(t,r){e["!"+t]=r},has:function(t){return"!"+t in e},"delete":function(t){return delete e["!"+t]},clear:function(){e={}}}};e.Map=function v(){var e={number:l(),string:i?l():h(),"boolean":l(),object:c(),"function":c(),unknown:c(),undefined:f(),"null":f()},t=0,r=[],n=this;if(i?n=Object.create(v.prototype,{size:{get:function(){return t},configurable:!1,enumerable:!1},get:{value:function(t){return e[typeof t].get(t)},writable:!1,configurable:!1,enumerable:!1},set:{value:function(n,i){this.has(n)||(r.push(n),t++),e[typeof n].set(n,i)},writable:!1,configurable:!1,enumerable:!1},has:{value:function(t){return e[typeof t].has(t)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(n){return this.has(n)?(t--,r.splice(r.indexOf(n),1),e[typeof n]["delete"](n)):!1},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){r.length=0;for(var n in e)e[n].clear();t=0},writable:!1,configurable:!1,enumerable:!1},forEach:{value:function(e,t){for(var n=0,i=r.length;i>n;n++)e.call(t,this.get(r[n]),r[n],this)},writable:!1,configurable:!1,enumerable:!1}}):(n.size=t,n.get=function(t){return e[typeof t].get(t)},n.set=function(n,i){this.has(n)||(r.push(n),this.size=++t),e[typeof n].set(n,i)},n.has=function(t){return e[typeof t].has(t)},n["delete"]=function(n){return this.has(n)?(this.size=--t,r.splice(r.indexOf(n),1),e[typeof n]["delete"](n)):!1},n.clear=function(){r.length=0;for(var n in e)e[n].clear();this.size=t=0},n.forEach=function(e,t){for(var n=0,i=r.length;i>n;n++)e.call(t,this.get(r[n]),r[n],this)}),arguments.length>0&&Array.isArray(arguments[0]))for(var a=arguments[0],o=0,u=a.length;u>o;o++)n.set(a[o][0],a[o][1]);return n}}if(!n){var p=e.Map;e.Map=function g(){var e=new p,t=0,r=[],n=Object.create(g.prototype,{size:{get:function(){return t},configurable:!1,enumerable:!1},get:{value:function(t){return e.get(t)},writable:!1,configurable:!1,enumerable:!1},set:{value:function(n,i){e.has(n)||(r.push(n),t++),e.set(n,i)},writable:!1,configurable:!1,enumerable:!1},has:{value:function(t){return e.has(t)},writable:!1,configurable:!1,enumerable:!1},"delete":{value:function(n){return e.has(n)?(t--,r.splice(r.indexOf(n),1),e["delete"](n)):!1},writable:!1,configurable:!1,enumerable:!1},clear:{value:function(){if("clear"in e)e.clear();else for(var n=0,i=r.length;i>n;n++)e["delete"](r[n]);r.length=0,t=0},writable:!1,configurable:!1,enumerable:!1},forEach:{value:function(e,t){for(var n=0,i=r.length;i>n;n++)e.call(t,this.get(r[n]),r[n],this)},writable:!1,configurable:!1,enumerable:!1}});if(arguments.length>0&&Array.isArray(arguments[0]))for(var i=arguments[0],a=0,o=i.length;o>a;a++)n.set(i[a][0],i[a][1]);return n}}}}(this),function(e){if("function"!=typeof e.TimeoutError){var t=function(e){Error.call(this),this.message=e,this.name=t.name,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)};t.prototype=e.hprose.createObject(Error.prototype),t.prototype.constructor=t}}(this),function(e,t){"use strict";function r(e){var r=Array.prototype.slice.call(arguments,1);return function(){e.apply(t,r)}}function n(e){delete f[e]}function i(e){var t=f[e];if(t)try{t()}finally{n(e)}}function a(e){return f[c]=r.apply(t,e),c++}if(!e.setImmediate){var o=e.document,u=e.MutationObserver||e.WebKitMutationObserver||e.MozMutationOvserver,s={},c=1,f={};s.mutationObserver=function(){var e=[],t=o.createTextNode(""),r=new u(function(){for(;e.length>0;)i(e.shift())});return r.observe(t,{characterData:!0}),function(){var r=a(arguments);return e.push(r),t.data=1&r,r}},s.messageChannel=function(){var t=new e.MessageChannel;return t.port1.onmessage=function(e){i(Number(e.data))},function(){var e=a(arguments);return t.port2.postMessage(e),e}},s.nextTick=function(){return function(){var t=a(arguments);return e.process.nextTick(r(i,t)),t}},s.postMessage=function(){var e=o.createElement("iframe");e.style.display="none",o.documentElement.appendChild(e);var t=e.contentWindow;t.document.write('<script>window.onmessage=function(){parent.postMessage(1, "*");};</script>'),t.document.close();var r=[];return window.addEventListener("message",function(){for(;r.length>0;)i(r.shift())}),function(){var e=a(arguments);return r.push(e),t.postMessage(1,"*"),e}},s.readyStateChange=function(){var e=o.documentElement;return function(){var t=a(arguments),r=o.createElement("script");return r.onreadystatechange=function(){i(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r),t}},s.setTimeout=function(){return function(){var t=a(arguments);return e.setTimeout(r(i,t),0),t}};var l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"undefined"==typeof e.process||"[object process]"!==Object.prototype.toString.call(e.process)||e.process.browser?o&&"onreadystatechange"in o.createElement("script")?l.setImmediate=s.readyStateChange():o&&u?l.setImmediate=s.mutationObserver():e.MessageChannel?l.setImmediate=s.messageChannel():o&&"postMessage"in e&&"addEventListener"in e?l.setImmediate=s.postMessage():l.setImmediate=s.setTimeout():l.setImmediate=s.nextTick(),l.clearImmediate=n}}(this),function(e,t){"use strict";function r(e){var t=this;N(t,{_subscribers:{value:[]},resolve:{value:this.resolve.bind(t)},reject:{value:this.reject.bind(t)}}),"function"==typeof e&&H(function(){try{t.resolve(e())}catch(r){t.reject(r)}})}function n(e){return e instanceof r}function i(t){return n(t)||D&&t instanceof e.Promise&&typeof("function"===t.then)}function a(e,t){var n="function"==typeof t?t:function(){return t},i=new r;return B(function(){try{i.resolve(n())}catch(e){i.reject(e)}},e),i}function o(e){var t=new r;return t.reject(e),t}function u(e){var t=new r;return t.resolve(e),t}function s(e){try{var t=e();return u(t)}catch(r){return o(r)}}function c(e){var t=new r;return e(t.resolve,t.reject),t}function f(e){var t=0;return Array.forEach(e,function(){++t}),t}function l(e){return e=i(e)?e:u(e),e.then(function(e){var t=e.length,n=f(e),a=new Array(t);if(0===n)return u(a);var o=new r;return Array.forEach(e,function(e,t){var r=i(e)?e:u(e);r.then(function(e){a[t]=e,0===--n&&o.resolve(a)},o.reject)}),o})}function h(){return l(arguments)}function p(e){return e=i(e)?e:u(e),e.then(function(e){var t=new r;return Array.forEach(e,function(e){var r=i(e)?e:u(e);r.then(t.resolve,t.reject)}),t})}function d(e){return e=i(e)?e:u(e),e.then(function(e){var t=e.length,n=f(e);if(0===n)throw new RangeError("any(): array must not be empty");var a=new Array(t),o=new r;return Array.forEach(e,function(e,t){var r=i(e)?e:u(e);r.then(o.resolve,function(e){a[t]=e,0===--n&&o.reject(a)})}),o})}function v(e){return e=i(e)?e:u(e),e.then(function(e){var t=e.length,n=f(e),a=new Array(t);if(0===n)return u(a);var o=new r;return Array.forEach(e,function(e,t){var r=i(e)?e:u(e);r.whenComplete(function(){a[t]=r.inspect(),0===--n&&o.resolve(a)})}),o})}function g(e){var r=Array.slice(arguments,1);return l(r).then(function(r){return e.apply(t,r)})}function w(e,t){var r=Array.slice(arguments,2);return l(r).then(function(r){return e.apply(t,r)})}function y(e,t){return function(){return l(arguments).then(function(r){return e.apply(t,r)})}}function m(e,t,r){return l(e).then(function(e){return e.forEach(t,r)})}function b(e,t,r){return l(e).then(function(e){return e.every(t,r)})}function T(e,t,r){return l(e).then(function(e){return e.some(t,r)})}function C(e,t,r){return l(e).then(function(e){return e.filter(t,r)})}function E(e,t,r){return l(e).then(function(e){return e.map(t,r)})}function A(e,t,r){return arguments.length>2?l(e).then(function(e){return i(r)||(r=u(r)),r.then(function(r){return e.reduce(t,r)})}):l(e).then(function(e){return e.reduce(t)})}function k(e,t,r){return arguments.length>2?l(e).then(function(e){return i(r)||(r=u(r)),r.then(function(r){return e.reduceRight(t,r)})}):l(e).then(function(e){return e.reduceRight(t)})}function S(e,t,r){return l(e).then(function(e){return i(t)||(t=u(t)),t.then(function(t){return e.indexOf(t,r)})})}function O(e,t,r){return l(e).then(function(e){return i(t)||(t=u(t)),t.then(function(t){return e.lastIndexOf(t,r)})})}function j(e,t,r){return l(e).then(function(e){return i(t)||(t=u(t)),t.then(function(t){return e.includes(t,r)})})}function _(e,t,r){return l(e).then(function(e){return e.find(t,r)})}function I(e,t,r){return l(e).then(function(e){return e.findIndex(t,r)})}function M(e,t,r){H(function(){try{var n=e(r);t.resolve(n)}catch(i){t.reject(i)}})}function x(e,t,r){e?M(e,t,r):t.reject(r)}function R(e,t,r,n,a){function o(i){R(e,t,r,n,i)}function u(e){x(t,n,e)}if(i(a))return a===r?void u(new TypeError("Self resolution")):void a.then(o,u);if(null!==a&&"object"==typeof a||"function"==typeof a){var s;try{s=a.then}catch(c){return void u(c)}if("function"==typeof s){var f=!0;try{return void s.call(a,function(e){f&&(f=!1,o(e))},function(e){f&&(f=!1,u(e))})}catch(c){f&&(f=!1,u(c))}return}}e?M(e,n,a):n.resolve(a)}function U(){var e=new r;N(this,{future:{value:e},complete:{value:e.resolve},completeError:{value:e.reject},isCompleted:{get:function(){return e._state!==F}}})}var F=0,L=1,P=2,N=e.hprose.defineProperties,W=e.hprose.createObject,D="Promise"in e,H=e.setImmediate,B=e.setTimeout,q=e.clearTimeout,z=e.TimeoutError;N(r,{delayed:{value:a},error:{value:o},sync:{value:s},value:{value:u},all:{value:l},race:{value:p},resolve:{value:u},reject:{value:o},promise:{value:c},isFuture:{value:n},isPromise:{value:i},join:{value:h},any:{value:d},settle:{value:v},attempt:{value:g},run:{value:w},wrap:{value:y},forEach:{value:m},every:{value:b},some:{value:T},filter:{value:C},map:{value:E},reduce:{value:A},reduceRight:{value:k},indexOf:{value:S},lastIndexOf:{value:O},includes:{value:j},find:{value:_},findIndex:{value:I}}),N(r.prototype,{_value:{writable:!0},_reason:{writable:!0},_state:{value:F,writable:!0},resolve:{value:function(e){if(this._state===F){this._state=L,this._value=e;for(var t=this._subscribers;t.length>0;){var r=t.shift();R(r.onfulfill,r.onreject,this,r.next,e)}}}},reject:{value:function(e){if(this._state===F){this._state=P,this._reason=e;for(var t=this._subscribers;t.length>0;){var r=t.shift();r.onreject?M(r.onreject,r.next,e):r.next.reject(e)}}}},then:{value:function(e,t){if("function"!=typeof e&&(e=null),"function"!=typeof t&&(t=null),e||t){var n=new r;return this._state===L?e?R(e,t,this,n,this._value):n.resolve(this._value):this._state===P?t?M(t,n,this._reason):n.reject(this._reason):this._subscribers.push({onfulfill:e,onreject:t,next:n}),n}return this}},inspect:{value:function(){switch(this._state){case F:return{state:"pending"};case L:return{state:"fulfilled",value:this._value};case P:return{state:"rejected",reason:this._reason}}}},catchError:{value:function(e,t){if("function"==typeof t){var r=this;return this["catch"](function(n){if(t(n))return r["catch"](e);throw n})}return this["catch"](e)}},"catch":{value:function(e){return this.then(null,e)}},whenComplete:{value:function(e){return this.then(function(r){var n=e();return n===t?r:(n=i(n)?n:u(n),n.then(function(){return r}))},function(r){var n=e();if(n===t)throw r;return n=i(n)?n:u(n),n.then(function(){throw r})})}},timeout:{value:function(e,t){var n=new r,i=B(function(){n.reject(t||new z("timeout"))},e);return this.whenComplete(function(){q(i)}).then(n.resolve,n.reject),n}},delay:{value:function(e){var t=new r;return this.then(function(r){B(function(){t.resolve(r)},e)},t.reject),t}},tap:{value:function(e,t){return this.then(function(r){return e.call(t,r),r})}},spread:{value:function(e,t){return this.then(function(r){return e.apply(t,r)})}},get:{value:function(e){return this.then(function(t){return t[e]})}},set:{value:function(e,t){return this.then(function(r){return r[e]=t,r})}},apply:{value:function(e,t){return t=t||[],this.then(function(r){return l(t).then(function(t){return r[e].apply(r,t)})})}},call:{value:function(e){var t=Array.slice(arguments,1);return this.then(function(r){return l(t).then(function(t){return r[e].apply(r,t)})})}},bind:{value:function(e){var t=Array.slice(arguments);{if(!Array.isArray(e)){t.shift();var r=this;return Object.defineProperty(this,e,{value:function(){var n=Array.slice(arguments);return r.then(function(r){return l(t.concat(n)).then(function(t){return r[e].apply(r,t)})})}}),this}for(var n=0,i=e.length;i>n;++n)t[0]=e[n],this.bind.apply(this,t)}}},forEach:{value:function(e,t){return m(this,e,t)}},every:{value:function(e,t){return b(this,e,t)}},some:{value:function(e,t){return T(this,e,t)}},filter:{value:function(e,t){return C(this,e,t)}},map:{value:function(e,t){return E(this,e,t)}},reduce:{value:function(e,t){return arguments.length>1?A(this,e,t):A(this,e)}},reduceRight:{value:function(e,t){return arguments.length>1?k(this,e,t):k(this,e)}},indexOf:{value:function(e,t){return S(this,e,t)}},lastIndexOf:{value:function(e,t){return O(this,e,t)}},includes:{value:function(e,t){return j(this,e,t)}},find:{value:function(e,t){return _(this,e,t)}},findIndex:{value:function(e,t){return I(this,e,t)}}}),e.hprose.Future=r,e.hprose.Completer=U,e.hprose.resolved=u,e.hprose.rejected=o,e.hprose.deferred=function(){var e=new r;return W(null,{promise:{value:e},resolve:{value:e.resolve},reject:{value:e.reject}})},D||(e.Promise=function(e){r.call(this),e(this.resolve,this.reject)},e.Promise.prototype=W(r.prototype),e.Promise.prototype.constructor=r,N(e.Promise,{all:{value:l},race:{value:p},resolve:{value:u},reject:{value:o}}))}(this),function(e){"use strict";function t(e){if(!/^[\x00-\xff]*$/.test(e))throw new Error("argument is not a binary string.");r(this,{length:{value:e.length},toString:{value:function(){return e}},valueOf:{value:function(){return e},writable:!0,configurable:!0,enumerable:!1}})}var r=e.hprose.defineProperties,n=e.hprose.createObject,i={};["quote","substring","toLowerCase","toUpperCase","charAt","charCodeAt","indexOf","lastIndexOf","include","startsWith","endsWith","repeat","trim","trimLeft","trimRight","toLocaleLowerCase","toLocaleUpperCase","match","search","replace","split","substr","concat","slice"].forEach(function(e){i[e]={value:String.prototype[e]}}),t.prototype=n(null,i),t.prototype.constructor=t,e.hprose.BinaryString=t,e.hprose.binary=function(e){return new t(e)}}(this),function(e,t){"use strict";function r(e){return String.fromCharCode(e>>>24&255,e>>>16&255,e>>>8&255,255&e)}function n(e){return String.fromCharCode(255&e,e>>>8&255,e>>>16&255,e>>>24&255)}function i(e){if(/^[\x00-\x7f]*$/.test(e))return e;for(var t=[],r=e.length,n=0,i=0;r>n;++n,++i){var a=e.charCodeAt(n);if(128>a)t[i]=e.charAt(n);else if(2048>a)t[i]=String.fromCharCode(192|a>>6,128|63&a);else{if(!(55296>a||a>57343)){if(r>n+1){var o=e.charCodeAt(n+1);if(56320>a&&o>=56320&&57343>=o){var u=((1023&a)<<10|1023&o)+65536;t[i]=String.fromCharCode(240|u>>18&63,128|u>>12&63,128|u>>6&63,128|63&u),++n;continue}}throw new Error("Malformed string")}t[i]=String.fromCharCode(224|a>>12,128|a>>6&63,128|63&a)}}return t.join("")}function a(e,t){for(var r=new Array(t),n=0,i=0,a=e.length;t>n&&a>i;n++){var o=e.charCodeAt(i++);switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r[n]=o;break;case 12:case 13:if(!(a>i))throw new Error("Unfinished UTF-8 octet sequence");r[n]=(31&o)<<6|63&e.charCodeAt(i++);break;case 14:if(!(a>i+1))throw new Error("Unfinished UTF-8 octet sequence");r[n]=(15&o)<<12|(63&e.charCodeAt(i++))<<6|63&e.charCodeAt(i++);break;case 15:if(!(a>i+2))throw new Error("Unfinished UTF-8 octet sequence");var u=((7&o)<<18|(63&e.charCodeAt(i++))<<12|(63&e.charCodeAt(i++))<<6|63&e.charCodeAt(i++))-65536;if(!(u>=0&&1048575>=u))throw new Error("Character outside valid Unicode range: 0x"+u.toString(16));r[n++]=u>>10&1023|55296,r[n]=1023&u|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+o.toString(16))}}return t>n&&(r.length=n),[String.fromCharCode.apply(String,r),i]}function o(e,t){for(var r=[],n=new Array(65535),i=0,a=0,o=e.length;t>i&&o>a;i++){var u=e.charCodeAt(a++);switch(u>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n[i]=u;break;case 12:case 13:if(!(o>a))throw new Error("Unfinished UTF-8 octet sequence");n[i]=(31&u)<<6|63&e.charCodeAt(a++);break;case 14:if(!(o>a+1))throw new Error("Unfinished UTF-8 octet sequence");n[i]=(15&u)<<12|(63&e.charCodeAt(a++))<<6|63&e.charCodeAt(a++);break;case 15:if(!(o>a+2))throw new Error("Unfinished UTF-8 octet sequence");var s=((7&u)<<18|(63&e.charCodeAt(a++))<<12|(63&e.charCodeAt(a++))<<6|63&e.charCodeAt(a++))-65536;if(!(s>=0&&1048575>=s))throw new Error("Character outside valid Unicode range: 0x"+s.toString(16));n[i++]=s>>10&1023|55296,n[i]=1023&s|56320;break;default:throw new Error("Bad UTF-8 encoding 0x"+u.toString(16))}if(i>=65534){var c=i+1;n.length=c,r[r.length]=String.fromCharCode.apply(String,n),t-=c,i=-1}}return i>0&&(n.length=i,r[r.length]=String.fromCharCode.apply(String,n)),[r.join(""),a]}function u(e,r){
return(r===t||null===r||0>r)&&(r=e.length),0===r?["",0]:/^[\x00-\x7f]*$/.test(e)||!/^[\x00-\xff]*$/.test(e)?r===e.length?[e,r]:[e.substr(0,r),r]:1e5>r?a(e,r):o(e,r)}function s(e,r){if((r===t||null===r||0>r)&&(r=e.length),0===r)return"";if(/^[\x00-\x7f]*$/.test(e))return r===e.length?e:e.substr(0,r);if(!/^[\x00-\xff]*$/.test(e))throw new Error("The first argument must be an UTF8 encode binary string.");for(var n=0,i=0,a=e.length;r>n&&a>i;n++){var o=e.charCodeAt(i++);switch(o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:if(!(a>i))throw new Error("Unfinished UTF-8 octet sequence");++i;break;case 14:if(!(a>i+1))throw new Error("Unfinished UTF-8 octet sequence");i+=2;break;case 15:if(a>i+2){var u=((7&o)<<18|(63&e.charCodeAt(i++))<<12|(63&e.charCodeAt(i++))<<6|63&e.charCodeAt(i++))-65536;if(u>=0&&1048575>=u)break;throw new Error("Character outside valid Unicode range: 0x"+u.toString(16))}throw new Error("Unfinished UTF-8 octet sequence");default:throw new Error("Bad UTF-8 encoding 0x"+o.toString(16))}}return e.substr(0,i)}function c(e){return u(e)[0]}function f(e){var t=e.length;if(/^[\x00-\x7f]*$/.test(e))return t;for(var r=0,n=0;t>n;++n){var i=e.charCodeAt(n);if(128>i)++r;else if(2048>i)r+=2;else{if(!(55296>i||i>57343)){if(t>n+1){var a=e.charCodeAt(n+1);if(56320>i&&a>=56320&&57343>=a){++n,r+=4;continue}}throw new Error("Malformed string")}r+=3}}return r}function l(e){var t=e.length;if(/^[\x00-\x7f]*$/.test(e)||!/^[\x00-\xff]*$/.test(e))return t;for(var r=0,n=0;t>n;++n,++r){var i=e.charCodeAt(n);switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:if(!(t>n))throw new Error("Unfinished UTF-8 octet sequence");++n;break;case 14:if(!(t>n+1))throw new Error("Unfinished UTF-8 octet sequence");n+=2;break;case 15:if(!(t>n+2))throw new Error("Unfinished UTF-8 octet sequence");var a=((7&i)<<18|(63&e.charCodeAt(n++))<<12|(63&e.charCodeAt(n++))<<6|63&e.charCodeAt(n++))-65536;if(!(a>=0&&1048575>=a))throw new Error("Character outside valid Unicode range: 0x"+a.toString(16));++r;break;default:throw new Error("Bad UTF-8 encoding 0x"+i.toString(16))}}return r}function h(e){if(/^[\x00-\x7f]*$/.test(e))return!0;if(!/^[\x00-\xff]*$/.test(e))return!1;for(var t=0,r=e.length;r>t;++t){var n=e.charCodeAt(t);switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;case 12:case 13:if(!(r>t))return!1;++t;break;case 14:if(!(r>t+1))return!1;t+=2;break;case 15:if(!(r>t+2))return!1;var i=((7&n)<<18|(63&e.charCodeAt(t++))<<12|(63&e.charCodeAt(t++))<<6|63&e.charCodeAt(t++))-65536;if(!(i>=0&&1048575>=i))return!1;break;default:return!1}}return!0}function p(){var e=arguments;switch(e.length){case 1:this._buffer=[e[0].toString()];break;case 2:this._buffer=[e[0].toString().substr(e[1])];break;case 3:this._buffer=[e[0].toString().substr(e[1],e[2])];break;default:this._buffer=[""]}this.mark()}var d=e.hprose.defineProperties;d(p.prototype,{_buffer:{writable:!0},_off:{value:0,writable:!0},_wmark:{writable:!0},_rmark:{writable:!0},toString:{value:function(){return this._buffer.length>1&&(this._buffer=[this._buffer.join("")]),this._buffer[0]}},length:{get:function(){return this.toString().length}},position:{get:function(){return this._off}},mark:{value:function(){this._wmark=this.length(),this._rmark=this._off}},reset:{value:function(){this._buffer=[this.toString().substr(0,this._wmark)],this._off=this._rmark}},clear:{value:function(){this._buffer=[""],this._wmark=0,this._off=0,this._rmark=0}},writeByte:{value:function(e){this._buffer.push(String.fromCharCode(255&e))}},writeInt32BE:{value:function(e){if(e===(0|e)&&2147483647>=e)return void this._buffer.push(r(e));throw new TypeError("value is out of bounds")}},writeUInt32BE:{value:function(e){if((2147483647&e)+2147483648===e&&e>=0)return void this._buffer.push(r(0|e));throw new TypeError("value is out of bounds")}},writeInt32LE:{value:function(e){if(e===(0|e)&&2147483647>=e)return void this._buffer.push(n(e));throw new TypeError("value is out of bounds")}},writeUInt32LE:{value:function(e){if((2147483647&e)+2147483648===e&&e>=0)return void this._buffer.push(n(0|e));throw new TypeError("value is out of bounds")}},writeUTF16AsUTF8:{value:function(e){this._buffer.push(i(e))}},writeUTF8AsUTF16:{value:function(e){this._buffer.push(c(e))}},write:{value:function(e){this._buffer.push(e)}},readByte:{value:function(){return this._off<this.length()?this._buffer[0].charCodeAt(this._off++):-1}},readChar:{value:function(){return this._off<this.length()?this._buffer[0].charAt(this._off++):""}},readInt32BE:{value:function(){var e=this.length(),t=this._buffer[0],r=this._off;if(e>r+3){var n=t.charCodeAt(r++)<<24|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<8|t.charCodeAt(r++);return this._off=r,n}throw new Error("EOF")}},readUInt32BE:{value:function(){var e=this.readInt32BE();return 0>e?(2147483647&e)+2147483648:e}},readInt32LE:{value:function(){var e=this.length(),t=this._buffer[0],r=this._off;if(e>r+3){var n=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;return this._off=r,n}throw new Error("EOF")}},readUInt32LE:{value:function(){var e=this.readInt32LE();return 0>e?(2147483647&e)+2147483648:e}},read:{value:function(e){var t=this._off,r=this.length();return t+e>r&&(e=r-t),0===e?"":(this._off=t+e,this._buffer[0].substring(t,this._off))}},skip:{value:function(e){var t=this.length();return this._off+e>t?(e=t-this._off,this._off=t):this._off+=e,e}},readString:{value:function(e){var t=this.length(),r=this._off,n=this._buffer[0],i=n.indexOf(e,r);return-1===i?(n=n.substr(r),this._off=t):(n=n.substring(r,i+1),this._off=i+1),n}},readUntil:{value:function(e){var t=this.length(),r=this._off,n=this._buffer[0],i=n.indexOf(e,r);return i===this._off?(n="",this._off++):-1===i?(n=n.substr(r),this._off=t):(n=n.substring(r,i),this._off=i+1),n}},readUTF8:{value:function(e){var t=this.length(),r=s(this._buffer[0].substring(this._off,Math.min(this._off+3*e,t)),e);return this._off+=r.length,r}},readUTF8AsUTF16:{value:function(e){var t=this.length(),r=u(this._buffer[0].substring(this._off,Math.min(this._off+3*e,t)),e);return this._off+=r[1],r[0]}},readUTF16AsUTF8:{value:function(e){return i(this.read(e))}},take:{value:function(){var e=this.toString();return this.clear(),e}},clone:{value:function(){return new p(this.toString())}},trunc:{value:function(){var e=this.toString().substring(this._off,this._length);this._buffer[0]=e,this._off=0,this._wmark=0,this._rmark=0}}}),d(p,{utf8Encode:{value:i},utf8Decode:{value:c},utf8Length:{value:f},utf16Length:{value:l},isUTF8:{value:h}}),e.hprose.StringIO=p}(this),function(e){"use strict";e.HproseTags=e.hprose.Tags={TagInteger:"i",TagLong:"l",TagDouble:"d",TagNull:"n",TagEmpty:"e",TagTrue:"t",TagFalse:"f",TagNaN:"N",TagInfinity:"I",TagDate:"D",TagTime:"T",TagUTC:"Z",TagBytes:"b",TagUTF8Char:"u",TagString:"s",TagGuid:"g",TagList:"a",TagMap:"m",TagClass:"c",TagObject:"o",TagRef:"r",TagPos:"+",TagNeg:"-",TagSemicolon:";",TagOpenbrace:"{",TagClosebrace:"}",TagQuote:'"',TagPoint:".",TagFunctions:"F",TagCall:"C",TagResult:"R",TagArgument:"A",TagError:"E",TagEnd:"z"}}(this),function(e){"use strict";function t(e,t){u.set(e,t),o[t]=e}function r(e){return u.get(e)}function n(e){return o[e]}var i=e.WeakMap,a=e.hprose.createObject,o=a(null),u=new i;e.HproseClassManager=e.hprose.ClassManager=a(null,{register:{value:t},getClassAlias:{value:r},getClass:{value:n}}),e.hprose.register=t,t(Object,"Object")}(this),function(e,t){"use strict";function r(e){var t=e.constructor,r=k.getClassAlias(t);if(r)return r;if(t.name)r=t.name;else{var n=t.toString();if(r=n.substr(0,n.indexOf("(")).replace(/(^\s*function\s*)|(\s*$)/gi,""),""===r||"Object"===r)return"function"==typeof e.getClassName?e.getClassName():"Object"}return"Object"!==r&&k.register(t,r),r}function n(e){S(this,{_stream:{value:e},_ref:{value:new T,writable:!0}})}function i(e){return new n(e)}function a(e,t,r){this.binary=!!r,S(this,{stream:{value:e},_classref:{value:O(null),writable:!0},_fieldsref:{value:[],writable:!0},_refer:{value:t?_:i(e)}})}function o(e,n){var i=e.stream;if(n===t||null===n||n.constructor===Function)return void i.write(A.TagNull);if(""===n)return void i.write(A.TagEmpty);switch(n.constructor){case Number:u(e,n);break;case Boolean:f(e,n);break;case String:1===n.length?(i.write(A.TagUTF8Char),i.write(e.binary?j(n):n)):e.writeStringWithRef(n);break;case E:if(!e.binary)throw new Error("The binary string does not support serialization in text mode.");e.writeBinaryWithRef(n);break;case Date:e.writeDateWithRef(n);break;case T:e.writeMapWithRef(n);break;default:if(Array.isArray(n))e.writeListWithRef(n);else{var a=r(n);"Object"===a?e.writeMapWithRef(n):e.writeObjectWithRef(n)}}}function u(e,t){var r=e.stream;t=t.valueOf(),t===(0|t)?t>=0&&9>=t?r.write(t):(r.write(A.TagInteger),r.write(t),r.write(A.TagSemicolon)):c(e,t)}function s(e,t){var r=e.stream;t>=0&&9>=t?r.write(t):(-2147483648>t||t>2147483647?r.write(A.TagLong):r.write(A.TagInteger),r.write(t),r.write(A.TagSemicolon))}function c(e,t){var r=e.stream;t!==t?r.write(A.TagNaN):t!==1/0&&t!==-(1/0)?(r.write(A.TagDouble),r.write(t),r.write(A.TagSemicolon)):(r.write(A.TagInfinity),r.write(t>0?A.TagPos:A.TagNeg))}function f(e,t){e.stream.write(t.valueOf()?A.TagTrue:A.TagFalse)}function l(e,t){e._refer.set(t);var r=e.stream;r.write(A.TagDate),r.write(("0000"+t.getUTCFullYear()).slice(-4)),r.write(("00"+(t.getUTCMonth()+1)).slice(-2)),r.write(("00"+t.getUTCDate()).slice(-2)),r.write(A.TagTime),r.write(("00"+t.getUTCHours()).slice(-2)),r.write(("00"+t.getUTCMinutes()).slice(-2)),r.write(("00"+t.getUTCSeconds()).slice(-2));var n=t.getUTCMilliseconds();0!==n&&(r.write(A.TagPoint),r.write(("000"+n).slice(-3))),r.write(A.TagUTC)}function h(e,t){e._refer.set(t);var r=e.stream,n=("0000"+t.getFullYear()).slice(-4),i=("00"+(t.getMonth()+1)).slice(-2),a=("00"+t.getDate()).slice(-2),o=("00"+t.getHours()).slice(-2),u=("00"+t.getMinutes()).slice(-2),s=("00"+t.getSeconds()).slice(-2),c=("000"+t.getMilliseconds()).slice(-3);"00"===o&&"00"===u&&"00"===s&&"000"===c?(r.write(A.TagDate),r.write(n),r.write(i),r.write(a)):"1970"===n&&"01"===i&&"01"===a?(r.write(A.TagTime),r.write(o),r.write(u),r.write(s),"000"!==c&&(r.write(A.TagPoint),r.write(c))):(r.write(A.TagDate),r.write(n),r.write(i),r.write(a),r.write(A.TagTime),r.write(o),r.write(u),r.write(s),"000"!==c&&(r.write(A.TagPoint),r.write(c))),r.write(A.TagSemicolon)}function p(e,t){e._refer.set(t);var r=e.stream,n=("00"+t.getHours()).slice(-2),i=("00"+t.getMinutes()).slice(-2),a=("00"+t.getSeconds()).slice(-2),o=("000"+t.getMilliseconds()).slice(-3);r.write(A.TagTime),r.write(n),r.write(i),r.write(a),"000"!==o&&(r.write(A.TagPoint),r.write(o)),r.write(A.TagSemicolon)}function d(e,t){e._refer.set(t);var r=e.stream;r.write(A.TagBytes);var n=t.length;n>0?(r.write(n),r.write(A.TagQuote),r.write(t)):r.write(A.TagQuote),r.write(A.TagQuote)}function v(e,t){e._refer.set(t);var r=e.stream,n=t.length;r.write(A.TagString),n>0?(r.write(n),r.write(A.TagQuote),r.write(e.binary?j(t):t)):r.write(A.TagQuote),r.write(A.TagQuote)}function g(e,t){e._refer.set(t);var r=e.stream,n=t.length;if(r.write(A.TagList),n>0){r.write(n),r.write(A.TagOpenbrace);for(var i=0;n>i;i++)o(e,t[i])}else r.write(A.TagOpenbrace);r.write(A.TagClosebrace)}function w(e,t){e._refer.set(t);var r=e.stream,n=[];for(var i in t)t.hasOwnProperty(i)&&"function"!=typeof t[i]&&(n[n.length]=i);var a=n.length;if(r.write(A.TagMap),a>0){r.write(a),r.write(A.TagOpenbrace);for(var u=0;a>u;u++)o(e,n[u]),o(e,t[n[u]])}else r.write(A.TagOpenbrace);r.write(A.TagClosebrace)}function y(e,t){e._refer.set(t);var r=e.stream,n=t.size;r.write(A.TagMap),n>0?(r.write(n),r.write(A.TagOpenbrace),t.forEach(function(t,r){o(e,r),o(e,t)})):r.write(A.TagOpenbrace),r.write(A.TagClosebrace)}function m(e,t){var n,i,a=e.stream,u=r(t);if(u in e._classref)i=e._classref[u],n=e._fieldsref[i];else{n=[];for(var s in t)t.hasOwnProperty(s)&&"function"!=typeof t[s]&&(n[n.length]=s.toString());i=b(e,u,n)}a.write(A.TagObject),a.write(i),a.write(A.TagOpenbrace),e._refer.set(t);for(var c=n.length,f=0;c>f;f++)o(e,t[n[f]]);a.write(A.TagClosebrace)}function b(e,t,r){var n=e.stream,i=r.length;if(n.write(A.TagClass),n.write(t.length),n.write(A.TagQuote),n.write(e.binary?j(t):t),n.write(A.TagQuote),i>0){n.write(i),n.write(A.TagOpenbrace);for(var a=0;i>a;a++)v(e,r[a])}else n.write(A.TagOpenbrace);n.write(A.TagClosebrace);var o=e._fieldsref.length;return e._classref[t]=o,e._fieldsref[o]=r,o}var T=e.Map,C=e.hprose.StringIO,E=e.hprose.BinaryString,A=e.hprose.Tags,k=e.hprose.ClassManager,S=e.hprose.defineProperties,O=e.hprose.createObject,j=C.utf8Encode,_=O(null,{set:{value:function(){}},write:{value:function(){return!1}},reset:{value:function(){}}});S(n.prototype,{_refcount:{value:0,writable:!0},set:{value:function(e){this._ref.set(e,this._refcount++)}},write:{value:function(e){var r=this._ref.get(e);return r!==t?(this._stream.write(A.TagRef),this._stream.write(r),this._stream.write(A.TagSemicolon),!0):!1}},reset:{value:function(){this._ref=new T,this._refcount=0}}}),S(a.prototype,{binary:{value:!1,writable:!0},serialize:{value:function(e){o(this,e)}},writeInteger:{value:function(e){s(this,e)}},writeDouble:{value:function(e){c(this,e)}},writeBoolean:{value:function(e){f(this,e)}},writeUTCDate:{value:function(e){l(this,e)}},writeUTCDateWithRef:{value:function(e){this._refer.write(e)||l(this,e)}},writeDate:{value:function(e){h(this,e)}},writeDateWithRef:{value:function(e){this._refer.write(e)||h(this,e)}},writeTime:{value:function(e){p(this,e)}},writeTimeWithRef:{value:function(e){this._refer.write(e)||p(this,e)}},writeBinary:{value:function(e){d(this,e)}},writeBinaryWithRef:{value:function(e){this._refer.write(e)||d(this,e)}},writeString:{value:function(e){v(this,e)}},writeStringWithRef:{value:function(e){this._refer.write(e)||v(this,e)}},writeList:{value:function(e){g(this,e)}},writeListWithRef:{value:function(e){this._refer.write(e)||g(this,e)}},writeMap:{value:function(e){e instanceof T?y(this,e):w(this,e)}},writeMapWithRef:{value:function(e){this._refer.write(e)||this.writeMap(e)}},writeObject:{value:function(e){m(this,e)}},writeObjectWithRef:{value:function(e){this._refer.write(e)||m(this,e)}},reset:{value:function(){this._classref=O(null),this._fieldsref.length=0,this._refer.reset()}}}),e.HproseWriter=e.hprose.Writer=a}(this),function(e,t){"use strict";function r(e,t){if(e&&t)throw new Error('Tag "'+t+'" expected, but "'+e+'" found in stream');if(e)throw new Error('Unexpected serialize tag "'+e+'" in stream');throw new Error("No byte found in stream")}function n(e,t){var r=new J;return i(e,r,t),r.take()}function i(e,t,r){a(e,t,e.readChar(),r)}function a(e,t,n,a){switch(t.write(n),n){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case te.TagNull:case te.TagEmpty:case te.TagTrue:case te.TagFalse:case te.TagNaN:break;case te.TagInfinity:t.write(e.read());break;case te.TagInteger:case te.TagLong:case te.TagDouble:case te.TagRef:o(e,t);break;case te.TagDate:case te.TagTime:u(e,t);break;case te.TagUTF8Char:s(e,t,a);break;case te.TagBytes:c(e,t,a);break;case te.TagString:f(e,t,a);break;case te.TagGuid:l(e,t);break;case te.TagList:case te.TagMap:case te.TagObject:h(e,t,a);break;case te.TagClass:h(e,t,a),i(e,t,a);break;case te.TagError:i(e,t,a);break;default:r(n)}}function o(e,t){var r;do r=e.read(),t.write(r);while(r!==te.TagSemicolon)}function u(e,t){var r;do r=e.read(),t.write(r);while(r!==te.TagSemicolon&&r!==te.TagUTC)}function s(e,t,r){r?t.write(e.readUTF8(1)):t.write(e.readChar())}function c(e,t,r){if(!r)throw new Error("The binary string does not support to unserialize in text mode.");var n=e.readUntil(te.TagQuote);t.write(n),t.write(te.TagQuote);var i=0;n.length>0&&(i=parseInt(n,10)),t.write(e.read(i+1))}function f(e,t,r){var n=e.readUntil(te.TagQuote);t.write(n),t.write(te.TagQuote);var i=0;n.length>0&&(i=parseInt(n,10)),r?t.write(e.readUTF8(i+1)):t.write(e.read(i+1))}function l(e,t){t.write(e.read(38))}function h(e,t,r){var n;do n=e.readChar(),t.write(n);while(n!==te.TagOpenbrace);for(;(n=e.readChar())!==te.TagClosebrace;)a(e,t,n,r);t.write(n)}function p(e,t){ne(this,{stream:{value:e},binary:{value:!!t,writable:!0},readRaw:{value:function(){return n(e,this.binary)}}})}function d(){ne(this,{ref:{value:[]}})}function v(){return new d}function g(r){var n,i=e,a=r.split(".");for(n=0;n<a.length;n++)if(i=i[a[n]],i===t)return null;return i}function w(e,t,r,n){if(r<t.length){var i=t[r];e[i]=n;var a=w(e,t,r+1,".");return r+1<t.length&&null===a&&(a=w(e,t,r+1,"_")),a}var o=e.join("");try{var u=g(o);return"function"==typeof u?u:null}catch(s){return null}}function y(e){var t=re.getClass(e);if(t)return t;if(t=g(e),"function"==typeof t)return re.register(t,e),t;for(var r=[],n=e.indexOf("_");n>=0;)r[r.length]=n,n=e.indexOf("_",n+1);if(r.length>0){var i=e.split("");if(t=w(i,r,0,"."),null===t&&(t=w(i,r,0,"_")),"function"==typeof t)return re.register(t,e),t}return t=function(){},ne(t.prototype,{getClassName:{value:function(){return e}}}),re.register(t,e),t}function m(e,t){var r=e.readUntil(t);return 0===r.length?0:parseInt(r,10)}function b(e){var t=e.stream,n=t.readChar();switch(n){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case te.TagInteger:return T(t);case te.TagLong:return E(t);case te.TagDouble:return k(t);case te.TagNull:return null;case te.TagEmpty:return"";case te.TagTrue:return!0;case te.TagFalse:return!1;case te.TagNaN:return NaN;case te.TagInfinity:return O(t);case te.TagDate:return _(e);case te.TagTime:return M(e);case te.TagBytes:return R(e);case te.TagUTF8Char:return F(e);case te.TagString:return P(e);case te.TagGuid:return W(e);case te.TagList:return H(e);case te.TagMap:return e.useHarmonyMap?X(e):q(e);case te.TagClass:return Y(e),G(e);case te.TagObject:return Q(e);case te.TagRef:return V(e);case te.TagError:throw new Error(N(e));default:r(n)}}function T(e){return m(e,te.TagSemicolon)}function C(e){var t=e.readChar();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case te.TagInteger:return T(e);default:r(t)}}function E(e){var t=e.readUntil(te.TagSemicolon),r=parseInt(t,10);return r.toString()===t?r:t}function A(e){var t=e.readChar();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case te.TagInteger:case te.TagLong:return E(e);default:r(t)}}function k(e){return parseFloat(e.readUntil(te.TagSemicolon))}function S(e){var t=e.readChar();switch(t){case"0":return 0;case"1":return 1;case"2":return 2;case"3":return 3;case"4":return 4;case"5":return 5;case"6":return 6;case"7":return 7;case"8":return 8;case"9":return 9;case te.TagInteger:case te.TagLong:case te.TagDouble:return k(e);case te.TagNaN:return NaN;case te.TagInfinity:return O(e);default:r(t)}}function O(e){return e.readChar()===te.TagNeg?-(1/0):1/0}function j(e){var t=e.readChar();switch(t){case te.TagTrue:return!0;case te.TagFalse:return!1;default:r(t)}}function _(e){var t,r=e.stream,n=parseInt(r.read(4),10),i=parseInt(r.read(2),10)-1,a=parseInt(r.read(2),10),o=r.readChar();if(o===te.TagTime){var u=parseInt(r.read(2),10),s=parseInt(r.read(2),10),c=parseInt(r.read(2),10),f=0;o=r.readChar(),o===te.TagPoint&&(f=parseInt(r.read(3),10),o=r.readChar(),o>="0"&&"9">=o&&(r.skip(2),o=r.readChar(),o>="0"&&"9">=o&&(r.skip(2),o=r.readChar()))),t=o===te.TagUTC?new Date(Date.UTC(n,i,a,u,s,c,f)):new Date(n,i,a,u,s,c,f)}else t=o===te.TagUTC?new Date(Date.UTC(n,i,a)):new Date(n,i,a);return e.refer.set(t),t}function I(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagDate:return _(e);case te.TagRef:return V(e);default:r(t)}}function M(e){var t,r=e.stream,n=parseInt(r.read(2),10),i=parseInt(r.read(2),10),a=parseInt(r.read(2),10),o=0,u=r.readChar();return u===te.TagPoint&&(o=parseInt(r.read(3),10),u=r.readChar(),u>="0"&&"9">=u&&(r.skip(2),u=r.readChar(),u>="0"&&"9">=u&&(r.skip(2),u=r.readChar()))),t=u===te.TagUTC?new Date(Date.UTC(1970,0,1,n,i,a,o)):new Date(1970,0,1,n,i,a,o),e.refer.set(t),t}function x(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagTime:return M(e);case te.TagRef:return V(e);default:r(t)}}function R(e){if(!e.binary)throw new Error("The binary string does not support to unserialize in text mode.");var t=e.stream,r=m(t,te.TagQuote),n=new ee(t.read(r));return t.skip(1),e.refer.set(n),n}function U(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagEmpty:return new ee("");case te.TagBytes:return R(e);case te.TagRef:return V(e);default:r(t)}}function F(e){return e.binary?e.stream.readUTF8AsUTF16(1):e.stream.read(1)}function L(e){var t,r=e.stream,n=m(r,te.TagQuote);return t=e.binary?r.readUTF8AsUTF16(n):r.read(n),r.skip(1),t}function P(e){var t=L(e);return e.refer.set(t),t}function N(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagEmpty:return"";case te.TagUTF8Char:return F(e);case te.TagString:return P(e);case te.TagRef:return V(e);default:r(t)}}function W(e){var t=e.stream;t.skip(1);var r=t.read(36);return t.skip(1),e.refer.set(r),r}function D(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagGuid:return W(e);case te.TagRef:return V(e);default:r(t)}}function H(e){var t=e.stream,r=[];e.refer.set(r);for(var n=m(t,te.TagOpenbrace),i=0;n>i;i++)r[i]=b(e);return t.skip(1),r}function B(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagList:return H(e);case te.TagRef:return V(e);default:r(t)}}function q(e){var t=e.stream,r={};e.refer.set(r);for(var n=m(t,te.TagOpenbrace),i=0;n>i;i++){var a=b(e),o=b(e);r[a]=o}return t.skip(1),r}function z(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagMap:return q(e);case te.TagRef:return V(e);default:r(t)}}function X(e){var t=e.stream,r=new Z;e.refer.set(r);for(var n=m(t,te.TagOpenbrace),i=0;n>i;i++){var a=b(e),o=b(e);r.set(a,o)}return t.skip(1),r}function $(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagMap:return X(e);case te.TagRef:return V(e);default:r(t)}}function Q(e){var t=e.stream,r=e.classref[m(t,te.TagOpenbrace)],n=new r.classname;e.refer.set(n);for(var i=0;i<r.count;i++)n[r.fields[i]]=b(e);return t.skip(1),n}function G(e){var t=e.stream.readChar();switch(t){case te.TagNull:return null;case te.TagClass:return Y(e),G(e);case te.TagObject:return Q(e);case te.TagRef:return V(e);default:r(t)}}function Y(e){for(var t=e.stream,r=L(e),n=m(t,te.TagOpenbrace),i=[],a=0;n>a;a++)i[a]=N(e);t.skip(1),r=y(r),e.classref.push({classname:r,count:n,fields:i})}function V(e){return e.refer.read(m(e.stream,te.TagSemicolon))}function K(e,t,r,n){p.call(this,e,n),this.useHarmonyMap=!!r,ne(this,{classref:{value:[]},refer:{value:t?ae:v()}})}var Z=e.Map,J=e.hprose.StringIO,ee=e.hprose.BinaryString,te=e.hprose.Tags,re=e.hprose.ClassManager,ne=e.hprose.defineProperties,ie=e.hprose.createObject;e.hprose.RawReader=p;var ae=ie(null,{set:{value:function(){}},read:{value:function(){r(te.TagRef)}},reset:{value:function(){}}});ne(d.prototype,{set:{value:function(e){this.ref.push(e)}},read:{value:function(e){return this.ref[e]}},reset:{value:function(){this.ref.length=0}}}),K.prototype=ie(p.prototype),K.prototype.constructor=K,ne(K.prototype,{useHarmonyMap:{value:!1,writable:!0},checkTag:{value:function(e,n){n===t&&(n=this.stream.readChar()),n!==e&&r(n,e)}},checkTags:{value:function(e,n){return n===t&&(n=this.stream.readChar()),e.indexOf(n)>=0?n:void r(n,e)}},unserialize:{value:function(){return b(this)}},readInteger:{value:function(){return C(this.stream)}},readLong:{value:function(){return A(this.stream)}},readDouble:{value:function(){return S(this.stream)}},readBoolean:{value:function(){return j(this.stream)}},readDateWithoutTag:{value:function(){return _(this)}},readDate:{value:function(){return I(this)}},readTimeWithoutTag:{value:function(){return M(this)}},readTime:{value:function(){return x(this)}},readBinaryWithoutTag:{value:function(){return R(this)}},readBinary:{value:function(){return U(this)}},readStringWithoutTag:{value:function(){return P(this)}},readString:{value:function(){return N(this)}},readGuidWithoutTag:{value:function(){return W(this)}},readGuid:{value:function(){return D(this)}},readListWithoutTag:{value:function(){return H(this)}},readList:{value:function(){return B(this)}},readMapWithoutTag:{value:function(){return this.useHarmonyMap?X(this):q(this)}},readMap:{value:function(){return this.useHarmonyMap?$(this):z(this)}},readObjectWithoutTag:{value:function(){return Q(this)}},readObject:{value:function(){return G(this)}},reset:{value:function(){this.classref.length=0,this.refer.reset()}}}),e.HproseReader=e.hprose.Reader=K}(this),function(e){"use strict";function t(e,t,r){var a=new n,o=new i(a,t,r);return o.serialize(e),a.take()}function r(e,t,r,i){return e instanceof n||(e=new n(e)),new a(e,t,r,i).unserialize()}var n=e.hprose.StringIO,i=e.hprose.Writer,a=e.hprose.Reader,o=e.hprose.createObject;e.hprose.Formatter=o(null,{serialize:{value:t},unserialize:{value:r}}),e.hprose.serialize=t,e.hprose.unserialize=r}(this),function(e){"use strict";e.HproseResultMode=e.hprose.ResultMode={Normal:0,Serialized:1,Raw:2,RawWithEndTag:3},e.hprose.Normal=e.hprose.ResultMode.Normal,e.hprose.Serialized=e.hprose.ResultMode.Serialized,e.hprose.Raw=e.hprose.ResultMode.Raw,e.hprose.RawWithEndTag=e.hprose.ResultMode.RawWithEndTag}(this),function(e,t){"use strict";function r(){}function n(n,i,a){function T(e,t){for(var r=0,n=qe.length;n>r;r++)e=qe[r].outputFilter(e,t);return e}function C(e,t){for(var r=qe.length-1;r>=0;r--)e=qe[r].inputFilter(e,t);return e}function E(e,t){return e=T(e,t),Je(e,t).then(function(e){return t.oneway?void 0:C(e,t)})}function A(e,t){return it.sendAndReceive(e,t)}function k(e,t,r,n){Ze(e,t).then(r,function(i){S(e,t,r,n)||n(i)})}function S(t,r,n,i){if(r.failswitch&&++xe>=Me.length&&(xe=0,Ie=Me[xe]),r.idempotent&&--r.retry>=0){var a=r.retry>=10?500:500*(10-r.retry);return e.setTimeout(function(){k(t,r,n,i)},a),!0}return!1}function O(e){var t={retry:Pe,idempotent:!0,failswitch:!0,timeout:Le,client:it,userdata:{}},r=function(t){var r=null;try{var n=new c(t),i=new l(n,!0),a=n.readChar();switch(a){case u.TagError:r=new Error(i.readString());break;case u.TagFunctions:var o=i.readList();i.checkTag(u.TagEnd),I(e,o);break;default:r=new Error("Wrong Response:\r\n"+t)}}catch(s){r=s}null!==r?$e.reject(r):$e.resolve(e)};k(v,t,r,$e.reject)}function j(e,t){return function(){return ze?L(e,t,Array.slice(arguments),!0):h.all(arguments).then(function(r){return L(e,t,r,!1)})}}function _(e,r,n,i,a){if(r[i]===t&&(r[i]={},(typeof a===w||a.constructor===Object)&&(a=[a]),Array.isArray(a)))for(var o=0;o<a.length;o++){var u=a[o];if(typeof u===w)r[i][u]=j(e,n+i+"_"+u);else for(var s in u)_(e,r[i],i+"_",s,u[s])}}function I(e,r){for(var n=0;n<r.length;n++){var i=r[n];if(typeof i===w)e[i]===t&&(e[i]=j(e,i));else for(var a in i)_(e,e,"",a,i[a])}}function M(e,t){for(var r=Math.min(e.length,t.length),n=0;r>n;++n)t[n]=e[n]}function x(e){return e?{mode:s.Normal,binary:Re,byref:Ue,simple:Fe,onsuccess:t,onerror:t,useHarmonyMap:Be,client:it,userdata:{}}:{mode:s.Normal,binary:Re,byref:Ue,simple:Fe,timeout:Le,retry:Pe,idempotent:Ne,failswitch:We,oneway:!1,sync:!1,onsuccess:t,onerror:t,useHarmonyMap:Be,client:it,userdata:{}}}function R(e,t,r,n){var i=x(n);if(t in e){var a=e[t];for(var o in a)o in i&&(i[o]=a[o])}for(var u=0,s=r.length;s>u&&typeof r[u]!==m;++u);if(u===s)return i;var c=r.splice(u,s-u);for(i.onsuccess=c[0],s=c.length,u=1;s>u;++u){var f=c[u];switch(typeof f){case m:i.onerror=f;break;case g:i.byref=f;break;case y:i.mode=f;break;case b:for(var l in f)l in i&&(i[l]=f[l])}}return i}function U(e,t,r){var n=new c;n.write(u.TagCall);var i=new f(n,r.simple,r.binary);return i.writeString(e),(t.length>0||r.byref)&&(i.reset(),i.writeList(t),r.byref&&i.writeBoolean(!0)),n}function F(e,t,r,n){return De?h.promise(function(i,a){He.push({batch:n,name:e,args:t,context:r,resolve:i,reject:a})}):n?H(e,t,r):D(e,t,r)}function L(e,t,r,n){return F(t,r,R(e,t,r,n),n)}function P(e,t,r,n){try{r.onerror?r.onerror(e,t):it.onerror&&it.onerror(e,t),n(t)}catch(i){n(i)}}function N(e,t,r){var n=U(e,t,r);return n.write(u.TagEnd),h.promise(function(e,i){k(n.toString(),r,function(n){if(r.oneway)return void e();var a=null,o=null;try{if(r.mode===s.RawWithEndTag)a=n;else if(r.mode===s.Raw)a=n.substring(0,n.byteLength-1);else{var f=new c(n),h=new l(f,!1,r.useHarmonyMap,r.binary),p=f.readChar();if(p===u.TagResult){if(a=r.mode===s.Serialized?h.readRaw():h.unserialize(),p=f.readChar(),p===u.TagArgument){h.reset();var d=h.readList();M(d,t),p=f.readChar()}}else p===u.TagError&&(o=new Error(h.readString()),p=f.readChar());p!==u.TagEnd&&(o=new Error("Wrong Response:\r\n"+n))}}catch(v){o=v}o?i(o):e(a)},i)})}function W(e){return function(){e&&(De=!1,o(function(e){e.forEach(function(e){"settings"in e?X(e.settings).then(e.resolve,e.reject):F(e.name,e.args,e.context,e.batch).then(e.resolve,e.reject)})},He),He=[])}}function D(e,t,r){r.sync&&(De=!0);var n=h.promise(function(n,i){Ve(e,t,r).then(function(a){try{if(r.onsuccess)try{r.onsuccess(a,t)}catch(o){r.onerror&&r.onerror(e,o),i(o)}n(a)}catch(o){i(o)}},function(t){P(e,t,r,i)})});return n.whenComplete(W(r.sync)),n}function H(e,t,r){return h.promise(function(n,i){Xe.push({args:t,name:e,context:r,resolve:n,reject:i})})}function B(e){var t={timeout:Le,binary:Re,retry:Pe,idempotent:Ne,failswitch:We,oneway:!1,sync:!1,client:it,userdata:{}};for(var r in e)r in t&&(t[r]=e[r]);return t}function q(e,t){var r=e.reduce(function(e,r){return r.context.binary=t.binary,e.write(U(r.name,r.args,r.context)),e},new c);return r.write(u.TagEnd),h.promise(function(n,i){k(r.toString(),t,function(r){if(t.oneway)return void n(e);var a=-1,o=new c(r),f=new l(o,!1,!1,t.binary),h=o.readChar();try{for(;h!==u.TagEnd;){var p=null,d=null,v=e[++a].context.mode;if(v>=s.Raw&&(p=new c),h===u.TagResult){if(v===s.Serialized?p=f.readRaw():v>=s.Raw?(p.write(u.TagResult),p.write(f.readRaw())):(f.useHarmonyMap=e[a].context.useHarmonyMap,f.reset(),p=f.unserialize()),h=o.readChar(),h===u.TagArgument){if(v>=s.Raw)p.write(u.TagArgument),p.write(f.readRaw());else{f.reset();var g=f.readList();M(g,e[a].args)}h=o.readChar()}}else h===u.TagError&&(v>=s.Raw?(p.write(u.TagError),p.write(f.readRaw())):(f.reset(),d=new Error(f.readString())),h=o.readChar());if([u.TagEnd,u.TagResult,u.TagError].indexOf(h)<0)return void i(new Error("Wrong Response:\r\n"+r));v>=s.Raw?(v===s.RawWithEndTag&&p.write(u.TagEnd),e[a].result=p.bytes):e[a].result=p,e[a].error=d}}catch(w){return void i(w)}n(e)},i)})}function z(){ze=!0}function X(e){if(e=e||{},ze=!1,De)return h.promise(function(t,r){He.push({batch:!0,settings:e,resolve:t,reject:r})});var t=Xe.length;if(0===t)return h.value([]);var r=B(e);r.sync&&(De=!0);var n=Xe;Xe=[];var i=h.promise(function(e,t){Ke(n,r).then(function(t){t.forEach(function(e){if(e.error)P(e.name,e.error,e.context,e.reject);else try{if(e.context.onsuccess)try{e.context.onsuccess(e.result,e.args)}catch(t){e.context.onerror&&e.context.onerror(e.name,t),e.reject(t)}e.resolve(e.result)}catch(t){e.reject(t)}delete e.context,delete e.resolve,delete e.reject}),e(t)},function(e){n.forEach(function(t){"reject"in t&&P(t.name,e,t.context,t.reject)}),t(e)})});return i.whenComplete(W(r.sync)),i}function $(){return Ie}function Q(){return Re}function G(e){Re=!!e}function Y(){return We}function V(e){We=!!e}function K(){return Le}function Z(e){Le="number"==typeof e?0|e:0}function J(){return Pe}function ee(e){Pe="number"==typeof e?0|e:0}function te(){return Ne}function re(e){Ne=!!e}function ne(e){Ye=!!e}function ie(){return Ye}function ae(){return Ue}function oe(e){Ue=!!e}function ue(){return Fe}function se(e){Fe=!!e}function ce(){return Be;
}function fe(e){Be=!!e}function le(){return 0===qe.length?null:1===qe.length?qe[0]:qe.slice()}function he(e){qe.length=0,Array.isArray(e)?e.forEach(function(e){pe(e)}):pe(e)}function pe(e){e&&"function"==typeof e.inputFilter&&"function"==typeof e.outputFilter&&qe.push(e)}function de(e){var t=qe.indexOf(e);return-1===t?!1:(qe.splice(t,1),!0)}function ve(){return qe}function ge(e,r,n){n===t&&(typeof r===g&&(n=r,r=!1),r||(typeof e===g?(n=e,e=!1):(e&&e.constructor===Object||Array.isArray(e))&&(r=e,e=!1)));var i=it;return n&&(i={}),e||Ie?(e&&(Ie=e),(typeof r===w||r&&r.constructor===Object)&&(r=[r]),Array.isArray(r)?(I(i,r),$e.resolve(i),i):(o(O,i),$e)):new Error("You should set server uri first!")}function we(e,t,n){var i=arguments.length;if(1>i||typeof e!==w)throw new Error("name must be a string");if(1===i&&(t=[]),2===i&&!Array.isArray(t)){var a=[];typeof t!==m&&a.push(r),a.push(t),t=a}if(i>2){typeof n!==m&&t.push(r);for(var o=2;i>o;o++)t.push(arguments[o])}return L(it,e,t,ze)}function ye(e,t){return $e.then(e,t)}function me(e,t,r){if(Qe[e]){var n=Qe[e];return n[t]?n[t]:null}return r&&(Qe[e]=d(null)),null}function be(e,r,n,i){if(typeof e!==w)throw new TypeError("topic name must be a string.");if(r===t||null===r){if(typeof n!==m)throw new TypeError("callback must be a function.");r=n}if(typeof r===m)return i=n,n=r,null===Ge&&(Ge=Ae()),void Ge.then(function(t){be(e,t,n,i)});if(typeof n!==m)throw new TypeError("callback must be a function.");if(h.isPromise(r))return void r.then(function(t){be(e,t,n,i)});i===t&&(i=Le);var a=me(e,r,!0);if(null===a){var o=function(){L(it,e,[r,a.handler,o,{idempotent:!0,failswitch:!1,timeout:i}],!1)};a={handler:function(t){var n=me(e,r,!1);if(n){if(null!==t)for(var i=n.callbacks,a=0,u=i.length;u>a;++a)try{i[a](t)}catch(s){}null!==me(e,r,!1)&&o()}},callbacks:[n]},Qe[e][r]=a,o()}else a.callbacks.indexOf(n)<0&&a.callbacks.push(n)}function Te(e,t,r){if(e)if(typeof r===m){var n=e[t];if(n){var i=n.callbacks,a=i.indexOf(r);a>=0&&(i[a]=i[i.length-1],i.length--),0===i.length&&delete e[t]}}else delete e[t]}function Ce(e,r,n){if(typeof e!==w)throw new TypeError("topic name must be a string.");if(r===t||null===r){if(typeof n!==m)return void delete Qe[e];r=n}if(typeof r===m&&(n=r,r=null),null===r)if(null===Ge){if(Qe[e]){var i=Qe[e];for(r in i)Te(i,r,n)}}else Ge.then(function(t){Ce(e,t,n)});else h.isPromise(r)?r.then(function(t){Ce(e,t,n)}):Te(Qe[e],r,n)}function Ee(){return Ge}function Ae(){return L(it,"#",[],!1)}function ke(e){et.push(e),Ve=et.reduceRight(function(e,t){return function(r,n,i){try{var a=t(r,n,i,e);return h.isFuture(a)?a:h.value(a)}catch(o){return h.error(o)}}},N)}function Se(e){tt.push(e),Ke=tt.reduceRight(function(e,t){return function(r,n){try{var i=t(r,n,e);return h.isFuture(i)?i:h.value(i)}catch(a){return h.error(a)}}},q)}function Oe(e){rt.push(e),Ze=rt.reduceRight(function(e,t){return function(r,n){try{var i=t(r,n,e);return h.isFuture(i)?i:h.value(i)}catch(a){return h.error(a)}}},E)}function je(e){nt.push(e),Je=nt.reduceRight(function(e,t){return function(r,n){try{var i=t(r,n,e);return h.isFuture(i)?i:h.value(i)}catch(a){return h.error(a)}}},A)}function _e(e){return ke(e),it}var Ie,Me=[],xe=-1,Re=!1,Ue=!1,Fe=!1,Le=3e4,Pe=10,Ne=!1,We=!1,De=!1,He=[],Be=!1,qe=[],ze=!1,Xe=[],$e=new h,Qe=d(null),Ge=null,Ye=!0,Ve=N,Ke=q,Ze=E,Je=A,et=[],tt=[],rt=[],nt=[],it=this;Ae.sync=!0,Ae.idempotent=!0,Ae.failswitch=!0;var at=d(null,{begin:{value:z},end:{value:X},use:{value:function(e){return Se(e),at}}}),ot=d(null,{use:{value:function(e){return Oe(e),ot}}}),ut=d(null,{use:{value:function(e){return je(e),ut}}});p(this,{"#":{value:Ae},onerror:{value:null,writable:!0},uri:{get:$},id:{get:Ee},binary:{get:Q,set:G},failswitch:{get:Y,set:V},timeout:{get:K,set:Z},retry:{get:J,set:ee},idempotent:{get:te,set:re},keepAlive:{get:ie,set:ne},byref:{get:ae,set:oe},simple:{get:ue,set:se},useHarmonyMap:{get:ce,set:fe},filter:{get:le,set:he},addFilter:{value:pe},removeFilter:{value:de},filters:{get:ve},useService:{value:ge},invoke:{value:we},ready:{value:ye},subscribe:{value:be},unsubscribe:{value:Ce},use:{value:_e},batch:{value:at},beforeFilter:{value:ot},afterFilter:{value:ut}}),a&&typeof a===b&&["failswitch","timeout","retry","idempotent","keepAlive","byref","simple","useHarmonyMap","filter","binary"].forEach(function(e){e in a&&it[e](a[e])}),typeof n===w?(Me=[n],xe=0,ge(n,i)):Array.isArray(n)&&(Me=n,xe=Math.floor(Math.random()*Me.length),ge(Me[xe],i))}function i(e){var t=document.createElement("a");t.href=e;var r=t.protocol;if("http:"!==r&&"https:"!==r&&"tcp:"!==r&&"tcp4:"!==r&&"tcp6:"!==r&&"tcps:"!==r&&"tcp4s:"!==r&&"tcp6s:"!==r&&"tls:"!==r&&"ws:"!==r&&"wss:"!==r)throw new Error("The "+r+" client isn't implemented.")}function a(t,r,n){try{return e.hprose.HttpClient.create(t,r,n)}catch(a){}try{return e.hprose.TcpClient.create(t,r,n)}catch(a){}try{return e.hprose.WebSocketClient.create(t,r,n)}catch(a){}if("string"==typeof t)i(t);else if(Array.isArray(t))throw t.forEach(function(e){i(e)}),new Error("Not support multiple protocol.");throw new Error("You should set server uri first!")}var o=e.setImmediate,u=e.hprose.Tags,s=e.hprose.ResultMode,c=e.hprose.StringIO,f=e.hprose.Writer,l=e.hprose.Reader,h=e.hprose.Future,p=e.hprose.defineProperties,d=e.hprose.createObject,v=u.TagEnd,g="boolean",w="string",y="number",m="function",b="object";p(n,{create:{value:a}}),e.HproseClient=e.hprose.Client=n}(this),function(e){"use strict";function t(){var t="Shockwave Flash",r="application/x-shockwave-flash",n="ShockwaveFlash.ShockwaveFlash",i=navigator.plugins,a=navigator.mimeTypes,o=0,u=!1;if(i&&i[t])o=i[t].description,!o||a&&a[r]&&!a[r].enabledPlugin||(o=o.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),o=parseInt(o.replace(/^(.*)\..*$/,"$1"),10));else if(e.ActiveXObject)try{u=!0;var s=new e.ActiveXObject(n);s&&(o=s.GetVariable("$version"),o&&(o=o.split(" ")[1].split(","),o=parseInt(o[0],10)))}catch(c){}return 10>o?0:u?1:2}function r(){var e=t();if(l=e>0){var r=document.createElement("div");r.style.width=0,r.style.height=0,1===e?r.innerHTML=["<object ",'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" ','type="application/x-shockwave-flash" ','width="0" height="0" id="',f,'" name="',f,'">','<param name="movie" value="',o,"FlashHttpRequest.swf?",+new Date,'" />','<param name="allowScriptAccess" value="always" />','<param name="quality" value="high" />','<param name="wmode" value="opaque" />',"</object>"].join(""):r.innerHTML='<embed id="'+f+'" src="'+o+"FlashHttpRequest.swf?"+ +new Date+'" type="application/x-shockwave-flash" width="0" height="0" name="'+f+'" allowScriptAccess="always" />',document.documentElement.appendChild(r)}}function n(){if(!g)for(u||c||r(),g=!0;d.length>0;){var e=d.shift();"function"==typeof e&&e()}}function i(e,t,r,n,i,a){r=encodeURIComponent(r),w?h.post(e,t,r,n,i,a):v.push(function(){h.post(e,t,r,n,i,a)})}var a=document.getElementsByTagName("script"),o=a[a.length-1].getAttribute("flashpath")||"";a=null;var u=void 0!==e.location&&"file:"===e.location.protocol,s="undefined"!=typeof XMLHttpRequest,c=!u&&s&&"withCredentials"in new XMLHttpRequest,f="flashhttprequest_as3",l=!1,h=null,p=[],d=[],v=[],g=!1,w=!1,y={};y.flashSupport=function(){return l},y.post=function(e,t,r,n,a,o){var u=-1;n&&(u=p.length,p[u]=n),g?i(e,t,r,u,a,o):d.push(function(){i(e,t,r,u,a,o)})},y.__callback=function(e,t,r){t=null!==t?decodeURIComponent(t):null,r=null!==r?decodeURIComponent(r):null,"function"==typeof p[e]&&p[e](t,r),delete p[e]},y.__jsReady=function(){return g},y.__setSwfReady=function(){for(h=-1!==navigator.appName.indexOf("Microsoft")?e[f]:document[f],w=!0,e.__flash__removeCallback=function(e,t){try{e&&(e[t]=null)}catch(r){}};v.length>0;){var t=v.shift();"function"==typeof t&&t()}},e.FlashHttpRequest=y,n()}(this),function(e,t){"use strict";function r(){if(null!==T)return new b(T);for(var e=["MSXML2.XMLHTTP","MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MsXML2.XMLHTTP.2.6","Microsoft.XMLHTTP","Microsoft.XMLHTTP.1.0","Microsoft.XMLHTTP.1"],t=e.length,r=0;t>r;r++)try{var n=new b(e[r]);return T=e[r],n}catch(i){}throw new Error("Could not find an installed XML parser")}function n(){if(y)return new g;if(b)return r();throw new Error("XMLHttpRequest is not supported by this browser.")}function i(){}function a(r,o,u){function p(e,t){var r=new c,a=n();a.open("POST",A.uri(),!0),m&&(a.withCredentials="true");for(var o in E)a.setRequestHeader(o,E[o]);return t.binary||a.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),a.onreadystatechange=function(){4===a.readyState&&(a.onreadystatechange=i,a.status&&(200===a.status?t.binary?r.resolve(h(a.response)):r.resolve(a.responseText):r.reject(new Error(a.status+":"+a.statusText))))},a.onerror=function(){r.reject(new Error("error"))},t.timeout>0&&(r=r.timeout(t.timeout).catchError(function(e){throw a.onreadystatechange=i,a.onerror=i,a.abort(),e},function(e){return e instanceof d})),t.binary?(a.responseType="arraybuffer",a.sendAsBinary(e)):a.send(e),r}function g(e,t){var r=new c,n=function(e,t){null===t?r.resolve(e):r.reject(new Error(t))};return v.post(A.uri(),E,e,n,t.timeout,t.binary),r}function y(t,r){var n=new c;return e.api.ajax({url:A.uri(),method:"post",data:{body:t},timeout:r.timeout,dataType:"text",headers:E,certificate:A.certificate},function(e,t){e?n.resolve(e):n.reject(new Error(t.msg))}),n}function b(){if(e.location===t)return!0;var r=document.createElement("a");return r.href=A.uri(),r.protocol!==e.location.protocol?!0:r.host!==e.location.host?!0:!1}function T(t,r){var n=v.flashSupport()&&!w&&!m&&(r.binary||b()),i="undefined"!=typeof e.api&&"undefined"!=typeof e.api.ajax,a=n?g(t,r):i?y(t,r):p(t,r);return r.oneway&&a.resolve(),a}function C(e,t){"content-type"!==e.toLowerCase()&&(t?E[e]=t:delete E[e])}if(this.constructor!==a)return new a(r,o,u);s.call(this,r,o,u);var E=f(null),A=this;l(this,{certificate:{value:null,writable:!0},setHeader:{value:C},sendAndReceive:{value:T}})}function o(e){var t=document.createElement("a");if(t.href=e,"http:"!==t.protocol&&"https:"!==t.protocol)throw new Error("This client desn't support "+t.protocol+" scheme.")}function u(e,t,r){if("string"==typeof e)o(e);else{if(!Array.isArray(e))throw new Error("You should set server uri first!");e.forEach(function(e){o(e)})}return new a(e,t,r)}var s=e.hprose.Client,c=e.hprose.Future,f=e.hprose.createObject,l=e.hprose.defineProperties,h=e.hprose.toBinaryString,p=e.hprose.toUint8Array,d=e.TimeoutError,v=e.FlashHttpRequest,g=e.XMLHttpRequest;e.plus&&e.plus.net&&e.plus.net.XMLHttpRequest?g=e.plus.net.XMLHttpRequest:document.addEventListener&&document.addEventListener("plusready",function(){g=e.plus.net.XMLHttpRequest},!1);var w=e.location!==t&&"file:"===e.location.protocol,y="undefined"!=typeof g,m=!w&&y&&"withCredentials"in new g,b=e.ActiveXObject,T=null;y&&"undefined"!=typeof Uint8Array&&!g.prototype.sendAsBinary&&(g.prototype.sendAsBinary=function(e){var t=p(e);this.send(ArrayBuffer.isView?t:t.buffer)}),l(a,{create:{value:u}}),e.HproseHttpClient=e.hprose.HttpClient=a}(this),function(e,t){"use strict";function r(){}function n(e,i,a){function d(){return 2147483647>C?++C:C=0}function v(e,t){var r=new o;r.writeInt32BE(e),k[e].binary?r.write(t):r.writeUTF16AsUTF8(t);var n=h(r.take());ArrayBuffer.isView?j.send(n):j.send(n.buffer)}function g(e){O.resolve(e)}function w(e){var r=new o(l(e.data)),n=r.readInt32BE(),i=A[n],a=k[n];if(delete A[n],delete k[n],i!==t){--E;var u=r.read(r.length()-4);a.binary||(u=o.utf8Decode(u)),i.resolve(u)}if(100>E&&S.length>0){++E;var s=S.shift();O.then(function(){v(s[0],s[1])})}0!==E||_.keepAlive()||T()}function y(e){A.forEach(function(t,r){t.reject(new Error(e.code+":"+e.reason)),delete A[r]}),E=0,j=null}function m(){O=new s,j=new p(_.uri()),j.binaryType="arraybuffer",j.onopen=g,j.onmessage=w,j.onerror=r,j.onclose=y}function b(e,t){(null===j||j.readyState===p.CLOSING||j.readyState===p.CLOSED)&&m();var r=new s,n=d();return A[n]=r,k[n]=t,t.timeout>0&&(r=r.timeout(t.timeout).catchError(function(e){throw delete A[n],--E,e},function(e){return e instanceof c})),100>E?(++E,O.then(function(){v(n,e)})):S.push([n,e]),t.oneway&&r.resolve(),r}function T(){null!==j&&(j.onopen=r,j.onmessage=r,j.onclose=r,j.close())}if("undefined"==typeof p)throw new Error("WebSocket is not supported by this browser.");if(this.constructor!==n)return new n(e,i,a);u.call(this,e,i,a);var C=0,E=0,A=[],k=[],S=[],O=null,j=null,_=this;f(this,{sendAndReceive:{value:b},close:{value:T}})}function i(e){var t=document.createElement("a");if(t.href=e,"ws:"!==t.protocol&&"wss:"!==t.protocol)throw new Error("This client desn't support "+t.protocol+" scheme.")}function a(e,t,r){if("string"==typeof e)i(e);else{if(!Array.isArray(e))throw new Error("You should set server uri first!");e.forEach(function(e){i(e)})}return new n(e,t,r)}var o=e.hprose.StringIO,u=e.hprose.Client,s=e.hprose.Future,c=e.TimeoutError,f=e.hprose.defineProperties,l=e.hprose.toBinaryString,h=e.hprose.toUint8Array,p=e.WebSocket||e.MozWebSocket;f(n,{create:{value:a}}),e.HproseWebSocketClient=e.hprose.WebSocketClient=n}(this),function(e,t){"use strict";function r(){}function n(e){var t=f[e.socketId];t.onreceive(c(e.data))}function i(e){var t=f[e.socketId];t.onerror(e.resultCode),t.destroy()}function a(){null===l&&(l=e.chrome.sockets.tcp,l.onReceive.addListener(n),l.onReceiveError.addListener(i)),this.socketId=new o,this.connected=!1,this.timeid=t,this.onclose=r,this.onconnect=r,this.onreceive=r,this.onerror=r}var o=e.hprose.Future,u=e.hprose.defineProperties,s=e.hprose.toUint8Array,c=e.hprose.toBinaryString,f={},l=null;u(a.prototype,{connect:{value:function(e,t,r){var n=this;l.create({persistent:r&&r.persistent},function(i){r&&("noDelay"in r&&l.setNoDelay(i.socketId,r.noDelay,function(e){0>e&&(n.socketId.reject(e),l.disconnect(i.socketId),l.close(i.socketId),n.onclose())}),"keepAlive"in r&&l.setKeepAlive(i.socketId,r.keepAlive,function(e){0>e&&(n.socketId.reject(e),l.disconnect(i.socketId),l.close(i.socketId),n.onclose())})),r&&r.tls?l.setPaused(i.socketId,!0,function(){l.connect(i.socketId,e,t,function(e){0>e?(n.socketId.reject(e),l.disconnect(i.socketId),l.close(i.socketId),n.onclose()):l.secure(i.socketId,function(t){0!==t?(n.socketId.reject(e),l.disconnect(i.socketId),l.close(i.socketId),n.onclose()):l.setPaused(i.socketId,!1,function(){n.socketId.resolve(i.socketId)})})})}):l.connect(i.socketId,e,t,function(e){0>e?(n.socketId.reject(e),l.disconnect(i.socketId),l.close(i.socketId),n.onclose()):n.socketId.resolve(i.socketId)})}),this.socketId.then(function(e){f[e]=n,n.connected=!0,n.onconnect(e)},function(e){n.onerror(e)})}},send:{value:function(e){e=s(e).buffer;var t=this,r=new o;return this.socketId.then(function(n){l.send(n,e,function(e){e.resultCode<0?(t.onerror(e.resultCode),r.reject(e.resultCode),t.destroy()):r.resolve(e.bytesSent)})}),r}},destroy:{value:function(){var e=this;this.connected=!1,this.socketId.then(function(t){l.disconnect(t),l.close(t),delete f[t],e.onclose()})}},ref:{value:function(){this.socketId.then(function(e){l.setPaused(e,!1)})}},unref:{value:function(){this.socketId.then(function(e){l.setPaused(e,!0)})}},clearTimeout:{value:function(){this.timeid!==t&&e.clearTimeout(this.timeid)}},setTimeout:{value:function(t,r){this.clearTimeout(),this.timeid=e.setTimeout(r,t)}}}),e.hprose.ChromeTcpSocket=a}(this),function(e,t){"use strict";function r(){}function n(){null===c&&(c=e.api.require("socketManager")),this.socketId=new i,this.connected=!1,this.timeid=t,this.onclose=r,this.onconnect=r,this.onreceive=r,this.onerror=r}var i=e.hprose.Future,a=e.hprose.defineProperties,o=e.atob,u=e.btoa,s={},c=null;a(n.prototype,{connect:{value:function(e,t,r){var n=this;c.createSocket({type:"tcp",host:e,port:t,timeout:r.timeout,returnBase64:!0},function(e){if(e)switch(e.state){case 101:break;case 102:n.socketId.resolve(e.sid);break;case 103:n.onreceive(o(e.data.replace(/\s+/g,"")));break;case 201:n.socketId.reject(new Error("Create TCP socket failed"));break;case 202:n.socketId.reject(new Error("TCP connection failed"));break;case 203:n.onclose(),n.onerror(new Error("Abnormal disconnect connection"));break;case 204:n.onclose();break;case 205:n.onclose(),n.onerror(new Error("Unknown error"))}}),this.socketId.then(function(e){s[e]=n,n.connected=!0,n.onconnect(e)},function(e){n.onerror(e)})}},send:{value:function(e){var t=this,r=new i;return this.socketId.then(function(n){c.write({sid:n,data:u(e),base64:!0},function(e,n){e.status?r.resolve():(t.onerror(new Error(n.msg)),r.reject(n.msg),t.destroy())})}),r}},destroy:{value:function(){var e=this;this.connected=!1,this.socketId.then(function(t){c.closeSocket({sid:t},function(t,r){t.status||e.onerror(new Error(r.msg))}),delete s[t]})}},ref:{value:r},unref:{value:r},clearTimeout:{value:function(){this.timeid!==t&&e.clearTimeout(this.timeid)}},setTimeout:{value:function(t,r){this.clearTimeout(),this.timeid=e.setTimeout(r,t)}}}),e.hprose.APICloudTcpSocket=n}(this),function(e,t){"use strict";function r(){}function n(e,t){e.onreceive=function(r){"receiveEntry"in e||(e.receiveEntry={stream:new p,headerLength:4,dataLength:-1,id:null});var n=e.receiveEntry,i=n.stream,a=n.headerLength,o=n.dataLength,u=n.id;for(i.write(r);;){if(0>o&&i.length()>=a&&(o=i.readInt32BE(),0!==(2147483648&o)&&(o&=2147483647,a=8)),8===a&&null===u&&i.length()>=a&&(u=i.readInt32BE()),!(o>=0&&i.length()-a>=o))break;t(i.read(o),u),a=4,u=null,i.trunc(),o=-1}n.stream=i,n.headerLength=a,n.dataLength=o,n.id=u}}function i(e){e&&(this.client=e,this.uri=this.client.uri(),this.size=0,this.pool=[],this.requests=[])}function a(e){i.call(this,e)}function o(e){i.call(this,e)}function u(e,t,r){function n(){return m}function i(e){m=!!e}function s(){return b}function c(e){b=!!e}function f(){return T}function l(e){"number"==typeof e?(T=0|e,1>T&&(T=10)):T=10}function p(){return C}function v(e){C="number"==typeof e?0|e:0}function g(e,t){var r=new d;return b?((null===E||E.uri!==y.uri)&&(E=new a(y)),E.sendAndReceive(e,r,t)):((null===A||A.uri!==y.uri)&&(A=new o(y)),A.sendAndReceive(e,r,t)),t.oneway&&r.resolve(),r}if(this.constructor!==u)return new u(e,t,r);h.call(this,e,t,r);var y=this,m=!0,b=!1,T=10,C=3e4,E=null,A=null;w(this,{noDelay:{get:n,set:i},fullDuplex:{get:s,set:c},maxPoolSize:{get:f,set:l},poolTimeout:{get:p,set:v},sendAndReceive:{value:g}})}function s(e){var t=document.createElement("a");t.href=e;var r=t.protocol;if("tcp:"!==r&&"tcp4:"!==r&&"tcp6:"!==r&&"tcps:"!==r&&"tcp4s:"!==r&&"tcp6s:"!==r&&"tls:"!==r)throw new Error("This client desn't support "+r+" scheme.")}function c(e,t,r){if("string"==typeof e)s(e);else{if(!Array.isArray(e))throw new Error("You should set server uri first!");e.forEach(function(e){s(e)})}return new u(e,t,r)}var f=e.hprose.ChromeTcpSocket,l=e.hprose.APICloudTcpSocket,h=e.hprose.Client,p=e.hprose.StringIO,d=e.hprose.Future,v=e.TimeoutError,g=e.hprose.createObject,w=e.hprose.defineProperties;w(i.prototype,{create:{value:function(){var t=document.createElement("a");t.href=this.uri;var r=t.protocol;t.protocol="http:";var n,i=t.hostname,a=parseInt(t.port,10);if("tcp:"===r||"tcp4:"===r||"tcp6:"===r)n=!1;else{if("tcps:"!==r&&"tcp4s:"!==r&&"tcp6s:"!==r&&"tls:"!==r)throw new Error("Unsupported "+r+" protocol!");n=!0}var o;if(e.chrome&&e.chrome.sockets&&e.chrome.sockets.tcp)o=new f;else{if(!e.api||!e.api.require)throw new Error("TCP Socket is not supported by this browser or platform.");o=new l}var u=this;return o.connect(i,a,{persistent:!0,tls:n,timeout:this.client.timeout(),noDelay:this.client.noDelay(),keepAlive:this.client.keepAlive()}),o.onclose=function(){--u.size},++this.size,o}}}),a.prototype=g(i.prototype,{fetch:{value:function(){for(var e=this.pool;e.length>0;){var t=e.shift();if(t.connected)return 0===t.count&&(t.clearTimeout(),t.ref()),t}return null}},init:{value:function(e){var t=this;e.count=0,e.futures={},e.envs={},e.timeoutIds={},n(e,function(r,n){var i=e.futures[n],a=e.envs[n];i&&(t.clean(e,n),0===e.count&&t.recycle(e),a.binary||(r=p.utf8Decode(r)),i.resolve(r))}),e.onerror=function(r){var n=e.futures;for(var i in n){var a=n[i];t.clean(e,i),a.reject(r)}}}},recycle:{value:function(e){e.unref(),e.setTimeout(this.client.poolTimeout(),function(){e.destroy()})}},clean:{value:function(r,n){r.timeoutIds[n]!==t&&(e.clearTimeout(r.timeoutIds[n]),delete r.timeoutIds[n]),delete r.futures[n],delete r.envs[n],--r.count,this.sendNext(r)}},sendNext:{value:function(e){if(e.count<10)if(this.requests.length>0){var t=this.requests.shift();t.push(e),this.send.apply(this,t)}else this.pool.push(e)}},send:{value:function(t,r,n,i,a){var o=this,u=i.timeout;u>0&&(a.timeoutIds[n]=e.setTimeout(function(){o.clean(a,n),0===a.count&&o.recycle(a),r.reject(new v("timeout"))},u)),a.count++,a.futures[n]=r,a.envs[n]=i;var s=t.length,c=new p;c.writeInt32BE(2147483648|s),c.writeInt32BE(n),i.binary?c.write(t):c.writeUTF16AsUTF8(t),a.send(c.take()).then(function(){o.sendNext(a)})}},getNextId:{value:function(){return this.nextid<2147483647?++this.nextid:this.nextid=0}},sendAndReceive:{value:function(e,t,r){var n=this.fetch(),i=this.getNextId();if(n)this.send(e,t,i,r,n);else if(this.size<this.client.maxPoolSize()){n=this.create(),n.onerror=function(e){t.reject(e)};var a=this;n.onconnect=function(){a.init(n),a.send(e,t,i,r,n)}}else this.requests.push([e,t,i,r])}}}),a.prototype.constructor=i,o.prototype=g(i.prototype,{fetch:{value:function(){for(var e=this.pool;e.length>0;){var t=e.shift();if(t.connected)return t.clearTimeout(),t.ref(),t}return null}},recycle:{value:function(e){e.unref(),e.setTimeout(this.client.poolTimeout(),function(){e.destroy()}),this.pool.push(e)}},clean:{value:function(n){n.onreceive=r,n.onerror=r,n.timeoutId!==t&&(e.clearTimeout(n.timeoutId),delete n.timeoutId)}},sendNext:{value:function(e){if(this.requests.length>0){var t=this.requests.shift();t.push(e),this.send.apply(this,t)}else this.recycle(e)}},send:{value:function(t,r,i,a){var o=this,u=i.timeout;u>0&&(a.timeoutId=e.setTimeout(function(){o.clean(a),o.recycle(a),r.reject(new v("timeout"))},u)),n(a,function(e){o.clean(a),o.sendNext(a),i.binary||(e=p.utf8Decode(e)),r.resolve(e)}),a.onerror=function(e){o.clean(a),r.reject(e)};var s=t.length,c=new p;c.writeInt32BE(s),i.binary?c.write(t):c.writeUTF16AsUTF8(t),a.send(c.take())}},sendAndReceive:{value:function(e,t,r){var n=this.fetch();if(n)this.send(e,t,r,n);else if(this.size<this.client.maxPoolSize()){n=this.create();var i=this;n.onerror=function(e){t.reject(e)},n.onconnect=function(){i.send(e,t,r,n)}}else this.requests.push([e,t,r])}}}),o.prototype.constructor=i,w(u,{create:{value:c}}),e.HproseTcpClient=e.hprose.TcpClient=u}(this),function(e){"use strict";e.hprose.common={Completer:e.hprose.Completer,Future:e.hprose.Future,ResultMode:e.hprose.ResultMode},e.hprose.io={StringIO:e.hprose.StringIO,ClassManager:e.hprose.ClassManager,Tags:e.hprose.Tags,RawReader:e.hprose.RawReader,Reader:e.hprose.Reader,Writer:e.hprose.Writer,Formatter:e.hprose.Formatter},e.hprose.client={Client:e.hprose.Client,HttpClient:e.hprose.HttpClient},"function"==typeof define&&(define.cmd?define("hprose",[],e.hprose):define.amd&&define("hprose",[],function(){return e.hprose})),"object"==typeof module&&"object"==typeof module.exports&&(module.exports=e.hprose)}(this);